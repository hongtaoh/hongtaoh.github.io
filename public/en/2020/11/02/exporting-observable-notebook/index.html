<a name="top"></a>
<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>郝鸿涛：Hongtao Hao</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" rel="stylesheet">

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/bash.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/python.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vega@5.17.0"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@4.17.0"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@6.12.2"></script>

<script>hljs.initHighlightingOnLoad();</script>



            <link rel="icon" href="https://hongtaoh.com/ht10.ico">





  </head>
  
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav" >
      <a href="/" class="nav-logo">
        <img src="/media/ht10.png"
         width="50"
         height="50"
         alt="Hongtao Hao">
      </a>

      <ul class="nav-links" >
        
        
           <li><a href="/">Home</a></li>
       
           <li><a href="/en/vitae/">Vitae</a></li>
       
           <li><a href="/en/projects/">Projects</a></li>
       
           <li><a href="/en/blog/">Blog</a></li>
       
           <li><a href="/en/apad/">APAD</a></li>
       
           <li><a href="/cn/blog/">中文</a></li>
       
       
      </ul>
</nav>
      </header>

<main class = "content" role="main">
<div style="text-align: center">

<h1>How to Embed An Observable Notebook in A Stand-alone Web Page</h1>

<p>Hongtao Hao 
 / 2020-11-02 </p>

<hr/>
</div>

<span class="article-toolbar">
  
  
  
  
  
  
  
  <a href='https://github.com/hongtaoh/hongtaoh.github.io/edit/sources/content/en/blog/2020-11-02-embed-observable-notebook-stand-alone.md'style="font-size: 24px; color: black;" target="_blank"><i class="fa fa-edit" aria-hidden="true" title="Suggest an edit of this page"></i>
  </a>
  
  
  
</span>


<aside class="toc">
Table of Contents:
<nav id="TableOfContents">
  <ul>
    <li><a href="#embed-directly-via-iframe">Embed directly via iframe</a></li>
    <li><a href="#embed-manually">Embed manually</a>
      <ul>
        <li><a href="#import-runtime-and--inspector">Import <code>Runtime</code> and  <code>Inspector</code></a></li>
        <li><a href="#import-your-observablehq-notebook">Import your ObservableHQ notebook</a></li>
        <li><a href="#assign-id-to-cells-you-are-importing">Assign <code>id</code> to cells you are importing</a></li>
        <li><a href="#apply-runtime-and-insepctor">Apply Runtime and Insepctor</a></li>
        <li><a href="#html-within-the-body">HTML within the <code>&lt;body&gt;</code></a></li>
        <li><a href="#what-if-i-have-more-than-one-notebook-in-one-webpage">What if I have more than one notebook in one webpage</a></li>
        <li><a href="#more-examples">More examples</a></li>
      </ul>
    </li>
  </ul>
</nav>
</aside>


<div class="body-text list-text">
<p>After designing data visualizations on <a href="https://observablehq.com" target="_blank" rel="noreferrer noopener">ObserbableHQ</a>

, you might want to present your them in a stand-alone webpage. This post is to teach you how to do it.</p>
<p>If you find my post not helpful, you can refer to <a href="https://observablehq.com/@observablehq/downloading-and-embedding-notebooks" target="_blank" rel="noreferrer noopener">Advanced Embedding and Downloading</a>

.</p>
<h2 id="embed-directly-via-iframe">Embed directly via iframe<a href="#embed-directly-via-iframe" class="header-anchor" ariaLabel="Anchor"> # </a></h2>
<p>It&rsquo;s relatively easy to embed a visualization directly . For <a href="https://observablehq.com/@hongtaoh/explrable-data" target="_blank" rel="noreferrer noopener">this example</a>

 of mine, to embed <a href="https://observablehq.com/@hongtaoh/explrable-data#D_chart" target="_blank" rel="noreferrer noopener">this chart</a>

, I just need the following codes:</p>
<pre tabindex="0"><code>&lt;iframe width=&quot;100%&quot; height=&quot;534&quot; frameborder=&quot;0&quot;
  src=&quot;https://observablehq.com/embed/@hongtaoh/explrable-data?cell=reset&amp;cell=add&amp;cell=D_chart&quot;&gt;&lt;/iframe&gt;
</code></pre><iframe width="100%" height="534" frameborder="0"
  src="https://observablehq.com/embed/@hongtaoh/explrable-data?cell=reset&cell=add&cell=D_chart"></iframe>
<p>To get the above lines of code, on your Observable Notebook, just click the <code>...</code> menu on the left side of a cell, then choose &ldquo;Embed&rdquo;. You will be directed to select cells to embed. Do as instructed. If you encounter problems with embedding, refer to <a href="https://observablehq.com/@jashkenas/handy-embed-code-generator" target="_blank" rel="noreferrer noopener">Handy Embed Code Generator</a>

, or <a href="https://observablehq.com/@observablehq/troubleshooting-embedding" target="_blank" rel="noreferrer noopener">Troubleshooting Embedding</a>

.</p>
<div class="tip">
<p>You might need to go to the top of your notebook. Next to &ldquo;(Re)publish&rdquo; and &ldquo;Like&rdquo;, you can see the <code>...</code> menu. Click it and choose &ldquo;Switch to classic&rdquo;. Then follow the above instructions and you&rsquo;ll be able to see the &ldquo;Embed&rdquo; option in the cell you choose.</p>
</div>
<p>As you can see, you don&rsquo;t have much freedom to edit the style of the elements, such as the font, and the positions of the buttons. And the loading may be slow.</p>
<h2 id="embed-manually">Embed manually<a href="#embed-manually" class="header-anchor" ariaLabel="Anchor"> # </a></h2>
<p>It&rsquo;s not very difficult to embed your visualizations manually in a stand-alone webpage. I am providing a minimal example <a href="https://hongtaoh.com/d3/explorable-data/" target="_blank" rel="noreferrer noopener">here</a>

, whose source codes can be seen <a href="https://github.com/hongtaoh/hongtaoh.github.io/blob/sources/static/d3/explorable-data/index.html" target="_blank" rel="noreferrer noopener">here</a>

. Go to the buttom of this source codes file, and pay attention to the codes between <code>&lt;script type=&quot;module&quot;&gt;</code> and <code>&lt;/script&gt;</code>.</p>
<p>Except for the part of &ldquo;HTML within the <code>&lt;body&gt;</code> &ldquo;, all other codes should be found between <code>&lt;script type=&quot;module&quot;&gt;</code> and <code>&lt;/script&gt;</code>, which can be either placed within <code>&lt;head&gt;</code> or <code>&lt;body&gt;</code>.</p>
<h3 id="import-runtime-and--inspector">Import <code>Runtime</code> and  <code>Inspector</code><a href="#import-runtime-and--inspector" class="header-anchor" ariaLabel="Anchor"> # </a></h3>
<p>First, import <code>Runtime</code> and <code>Inspector</code>:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#008000;font-weight:bold">import</span> {Runtime, Inspector} from <span style="color:#ba2121">&#34;https://cdn.jsdelivr.net/npm/@observablehq/runtime@4/dist/runtime.js&#34;</span>;
</code></pre></div><h3 id="import-your-observablehq-notebook">Import your ObservableHQ notebook<a href="#import-your-observablehq-notebook" class="header-anchor" ariaLabel="Anchor"> # </a></h3>
<p>Then, we import the notebook you want to export. You can name it anything you like, not necessarily as <code>D3ExplorableNotebook</code>. You&rsquo;ll find that the notebook is always imported from <code>https://api.observablehq.com/@yourUsername/yourNotebook.js?v=3</code>. Edit it based on your own Observable username and your notebook URL.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#008000;font-weight:bold">import</span> D3ExplorableNotebook from <span style="color:#ba2121">&#34;https://api.observablehq.com/@hongtaoh/explrable-data.js?v=3&#34;</span>;
</code></pre></div><p>One thing worth noticing is that you can export private notebook as well, for example, forked notebooks you are working on, or those you don&rsquo;t want other people to see yet. To do that, go to the homepage of ObservableHQ, on the left side of the page, click &ldquo;notebooks&rdquo;, find your unpublished notebook, right click the <code>...</code> menu, and choose &ldquo;Enable link sharing&rdquo;. For private notebooks, the username will be simply <code>d</code>, and the notebook id is that after <code>d</code> shown in your notebook&rsquo;s URL.</p>
<h3 id="assign-id-to-cells-you-are-importing">Assign <code>id</code> to cells you are importing<a href="#assign-id-to-cells-you-are-importing" class="header-anchor" ariaLabel="Anchor"> # </a></h3>
<p>Next, we define an object in which we assign <code>id</code> to the cells we want to import &amp; present:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#008000;font-weight:bold">const</span> rendersExplorable <span style="color:#666">=</span> {
      	<span style="color:#ba2121">&#34;viewof season&#34;</span><span style="color:#666">:</span> <span style="color:#ba2121">&#34;#viewof-season&#34;</span>,
        <span style="color:#ba2121">&#34;TimeSeason&#34;</span><span style="color:#666">:</span> <span style="color:#ba2121">&#34;#TimeSeason&#34;</span>,
        <span style="color:#ba2121">&#34;viewof CI&#34;</span><span style="color:#666">:</span> <span style="color:#ba2121">&#34;#viewof-CI&#34;</span>,
        <span style="color:#ba2121">&#34;CIbody&#34;</span><span style="color:#666">:</span> <span style="color:#ba2121">&#34;#CIbody&#34;</span>,
        <span style="color:#ba2121">&#34;dataset&#34;</span><span style="color:#666">:</span> <span style="color:#ba2121">&#34;#dataset&#34;</span>,
        <span style="color:#ba2121">&#34;reset&#34;</span><span style="color:#666">:</span> <span style="color:#ba2121">&#34;#reset&#34;</span>,
        <span style="color:#ba2121">&#34;add&#34;</span><span style="color:#666">:</span> <span style="color:#ba2121">&#34;#add&#34;</span>,
        <span style="color:#ba2121">&#34;D_chart&#34;</span><span style="color:#666">:</span> <span style="color:#ba2121">&#34;#chart&#34;</span>,
      }
</code></pre></div><p>The object does not have to be named as <code>rendersExplorable</code>; Name it anything you like. As you can see, within the curly brackets, we assign <code>id</code> to each of the cells we want to import. With <code>id</code>, we can 1) put visualizations into specific places within the webpage, and 2) edit their styles with CSS.</p>
<h3 id="apply-runtime-and-insepctor">Apply Runtime and Insepctor<a href="#apply-runtime-and-insepctor" class="header-anchor" ariaLabel="Anchor"> # </a></h3>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#008000;font-weight:bold">const</span> runtimeExplorable <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">new</span> Runtime();
      
<span style="color:#008000;font-weight:bold">const</span> mainExplorable <span style="color:#666">=</span> runtimeExplorable.module(D3ExplorableNotebook, name =&gt; {
  <span style="color:#008000;font-weight:bold">const</span> selector <span style="color:#666">=</span> rendersExplorable[name];
  <span style="color:#008000;font-weight:bold">if</span> (selector) {
        <span style="color:#008000;font-weight:bold">return</span> <span style="color:#008000;font-weight:bold">new</span> Inspector(<span style="color:#008000">document</span>.querySelector(selector));
     } <span style="color:#008000;font-weight:bold">else</span> {
         <span style="color:#008000;font-weight:bold">return</span> <span style="color:#008000;font-weight:bold">true</span>;
     }
});
</code></pre></div><p>The above codes are from <a href="https://github.com/covid19-data/covid19-dashboard/blob/master/index.html" target="_blank" rel="noreferrer noopener">covid19-data/covid19-dashboard</a>

.</p>
<p><code>runtimeExplorabl</code> and <code>mainExplorable</code> are variables, so you can name it anyway you would like.</p>
<p>The <code>D3ExplorableNotebook</code> in the second line should the name your imported notebook. In the third line, <code>rendersExplorable</code> should be the name you assign <code>id</code>s to cells.</p>
<h3 id="html-within-the-body">HTML within the <code>&lt;body&gt;</code><a href="#html-within-the-body" class="header-anchor" ariaLabel="Anchor"> # </a></h3>
<p>You can study the <a href="https://github.com/hongtaoh/hongtaoh.github.io/blob/sources/static/d3/explorable-data/index.html" target="_blank" rel="noreferrer noopener">source code</a>

 in detail. I&rsquo;ll explain the basic ideas here. With <code>&lt;div id=&quot;viewof-season&quot;&gt;&lt;/div&gt;</code>, we&rsquo;ll put the relevant visualization there. If needed, you can edit the style within the CSS stylesheet with <code>#viewof-season {}</code>. I barely used any CSS in my example, so I simply place the CSS code within <code>style</code> tags of the webpage. If you want more complicated styling, of course you can (and probably should) reference an external CSS stylesheet.</p>
<p>Two points are worth mentioning:</p>
<ol>
<li>
<p>Each <a href="/en/2020/11/02/exporting-observable-notebook/#assign-id-to-cells-you-are-importing"><code>id</code> you assigned above</a>

 has to be used here. If there is an unused <code>id</code>, the whole web page won&rsquo;t render. If that is your case, delete the unnecessary id(s) <a href="/en/2020/11/02/exporting-observable-notebook/#assign-id-to-cells-you-are-importing">above</a>

.</p>
</li>
<li>
<p>Each <code>id</code> can be used only for once. If you use an <code>id</code> twice, only the first one will be rendered.</p>
</li>
</ol>
<h3 id="what-if-i-have-more-than-one-notebook-in-one-webpage">What if I have more than one notebook in one webpage<a href="#what-if-i-have-more-than-one-notebook-in-one-webpage" class="header-anchor" ariaLabel="Anchor"> # </a></h3>
<p>It&rsquo;s not that difficult. First, import the second/third/&hellip; notebook as you import the first one. Remember that you need to use different names for different notebooks, for example, <code>import notebook2 from ...</code>, and <code>import notebook3 from ...</code>.</p>
<p>Also, you need a different name than <code>renders</code> in <code>const renders = {}</code>. Maybe <code>const rendersTwo = {}</code> and <code>const rendersThree = {}</code>. Then, use different names than <code>runtime</code> in the last steps.</p>
<p>For example, for the second notebook, it might be:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-js" data-lang="js"><span style="color:#008000;font-weight:bold">const</span> runtime2 <span style="color:#666">=</span> <span style="color:#008000;font-weight:bold">new</span> Runtime();
<span style="color:#008000;font-weight:bold">const</span> main2 <span style="color:#666">=</span> runtime2.module(notebook2, name =&gt; {
   <span style="color:#008000;font-weight:bold">const</span> selector <span style="color:#666">=</span> rendersTwo[name];
   <span style="color:#008000;font-weight:bold">if</span> (selector) {
        <span style="color:#008000;font-weight:bold">return</span> <span style="color:#008000;font-weight:bold">new</span> Inspector(<span style="color:#008000">document</span>.querySelector(selector));
     } <span style="color:#008000;font-weight:bold">else</span> {
         <span style="color:#008000;font-weight:bold">return</span> <span style="color:#008000;font-weight:bold">true</span>;
     }
  });
</code></pre></div><p>After that, edit the <code>body</code> section as necessary.</p>
<p>If you don&rsquo;t understand it, study <a href="https://hongtaoh.com/d3/explorable-data/" target="_blank" rel="noreferrer noopener">my example</a>

, and its <a href="https://github.com/hongtaoh/hongtaoh.github.io/blob/sources/static/d3/explorable-data/index.html" target="_blank" rel="noreferrer noopener">source code</a>

.</p>
<h3 id="more-examples">More examples<a href="#more-examples" class="header-anchor" ariaLabel="Anchor"> # </a></h3>
<p>You can have a look at more examples of importing an Observable notebook in <a href="https://github.com/observablehq/examples/blob/main/breakout/index.html" target="_blank" rel="noreferrer noopener">observablehq/examples</a>

.</p>

<p style="color:#777;">Last modified on 2021-10-05</p>
</div>
<a href="#top"><i class="fa fa-chevron-up" style="font-size: 30px; color: black;"></i></a>

</main>

<footer class="footer">
<script src="https://utteranc.es/client.js"
        repo="hongtaoh/hongtaoh.github.io"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
  <script type="text/javascript" src="/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script type="text/javascript" src="/js/center-img.js"></script>



     <ul class="footer-links">
      
       
       
       
       <li><a href="/en/blog/index.xml" type="application/rss+xml" title="RSS feed">
       Subscribe </a>
       </li>
       
       
       <li>
       
        <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">
       
        License
        <i class="fa fa-cc" aria-hidden="true" title="Attribution-NonCommercial-ShareAlike 4.0 International"></i> 
        </a>
       </li>
       
     </ul>
     <div class="copyright-text">
            
            ©
            
            Hongtao Hao
            
            2020-2021
            
     </div>
</footer>





