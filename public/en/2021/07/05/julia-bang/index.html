<a name="top"></a>
<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>郝鸿涛：Hongtao Hao</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css" rel="stylesheet">

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/highlight.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/r.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/bash.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/languages/python.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vega@5.17.0"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-lite@4.17.0"></script>
<script src="https://cdn.jsdelivr.net/npm/vega-embed@6.12.2"></script>

<script>hljs.initHighlightingOnLoad();</script>



            <link rel="icon" href="https://hongtaoh.com/ht10.ico">





  </head>
  
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav" >
      <a href="/" class="nav-logo">
        <img src="/media/ht10.png"
         width="50"
         height="50"
         alt="Hongtao Hao">
      </a>

      <ul class="nav-links" >
        
        
           <li><a href="/">Home</a></li>
       
           <li><a href="/en/vitae/">Vitae</a></li>
       
           <li><a href="/en/projects/">Projects</a></li>
       
           <li><a href="/en/blog/">Blog</a></li>
       
           <li><a href="/en/apad/">APAD</a></li>
       
           <li><a href="/cn/blog/">中文</a></li>
       
       
      </ul>
</nav>
      </header>

<main class = "content" role="main">
<div style="text-align: center">

<h1>Julia: So What&#39;s the Difference Between ! and : In Dataframes Indexing</h1>

<p>Hongtao Hao 
 / 2021-07-05 </p>

<hr/>
</div>

<span class="article-toolbar">
  
  
  
  
  
  
  
  <a href='https://github.com/hongtaoh/hongtaoh.github.io/edit/sources/content/en/blog/2021-07-05-julia-bang.md'style="font-size: 24px; color: black;" target="_blank"><i class="fa fa-edit" aria-hidden="true" title="Suggest an edit of this page"></i>
  </a>
  
  
  
</span>


<aside class="toc">
Table of Contents:
<nav id="TableOfContents">
  <ul>
    <li><a href="#accessing-columns">Accessing column(s)</a></li>
    <li><a href="#updating-columns">Updating column(s)</a>
      <ul>
        <li><a href="#so-how-in-place-changes-are-different-from-creating-and-replacing">So, how in-place changes are different from creating and replacing?</a></li>
        <li><a href="#broadcasting">Broadcasting</a></li>
        <li><a href="#updating-the-value-of-a-single-cell">Updating the value of a single cell</a></li>
      </ul>
    </li>
    <li><a href="#adding-a-column">Adding a column</a></li>
    <li><a href="#getproperty-or-dfcol"><code>getproperty</code>, or <code>df.col</code></a></li>
    <li><a href="#conclusion">Conclusion</a>
      <ul>
        <li><a href="#a-table-summarizing-the-key-points">A table summarizing the key points</a></li>
        <li><a href="#best-practices">Best practices</a></li>
      </ul>
    </li>
  </ul>
</nav>
</aside>


<div class="body-text list-text">
<p><div class="warning">
Unless you are able to constantly moniter and update changes in this post, please DO NOT repost it anywere. Feel free to share the link, though.
</div></p>
<p><div class="tip">
The following codes were tested under Julia v1.6.1 and DataFrames v1.2.0.
</div></p>
<p>Similar discussions are found in <a href="https://stackoverflow.com/q/60900001/13716814" target="_blank" rel="noreferrer noopener">this thread on stackoverflow</a>

 and Bogumił Kamiński&rsquo;s post of <a href="https://bkamins.github.io/julialang/2021/01/30/bang.html" target="_blank" rel="noreferrer noopener"><em>On the bang row selector in DataFrames.jl</em></a>

.</p>
<p>I&rsquo;ll talk about the differences between <code>df[!, col(s)]</code> and <code>df[:, col(s)]</code> from three aspects: accessing, updating, and adding column(s).</p>
<h2 id="accessing-columns">Accessing column(s)<a href="#accessing-columns" class="header-anchor" ariaLabel="Anchor"> # </a></h2>
<p>When <code>df[!, col(s)]</code> or <code>df[:, col(s)]</code> are on the right hand side of the equal sign <code>=</code>, you are <strong>accessing</strong> the column(s). For example, <code>col1 = df[:, 1]</code>, in which you are accessing the first column of <code>df</code>.</p>
<p>When &ldquo;accessing&rdquo; column(s), <code>df[:, col(s)]</code> will make a copy of the column(s) and assign it to the variable you are declaring; in this case, <code>col1</code>. By contrast, <code>df[!, col(s)]</code> <a href="https://dataframes.juliadata.org/latest/man/getting_started/#The-DataFrame-Type-1" target="_blank" rel="noreferrer noopener">won&rsquo;t make a copy</a>

. As <a href="https://stackoverflow.com/a/60900196/13716814" target="_blank" rel="noreferrer noopener">fredrikekre rightly puts it</a>

:</p>
<blockquote>
<p>(It is) a reference to the underlying vector storing the data, rather than a copy of it.</p>
</blockquote>
<p>Since it&rsquo;s not a copy but a reference to the column(s) of <code>df</code> itself, if we modify <code>col1</code> (if declared with <code>[df[!, col]</code>), <code>df</code> will be mutated as well.</p>
<p>For example:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">julia&gt; <span style="color:#19177c">df1</span> <span style="color:#666">=</span> DataFrame<span style="color:#666">(</span><span style="color:#19177c">col1</span><span style="color:#666">=</span>1:3, <span style="color:#19177c">col2</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;a&#39;</span>:<span style="color:#ba2121">&#39;c&#39;</span><span style="color:#666">)</span>
3×2 DataFrame
 Row │ col1   col2 
     │ Int64  Char 
─────┼─────────────
   <span style="color:#666">1</span> │     <span style="color:#666">1</span>  a
   <span style="color:#666">2</span> │     <span style="color:#666">2</span>  b
   <span style="color:#666">3</span> │     <span style="color:#666">3</span>  c

julia&gt; <span style="color:#19177c">a</span> <span style="color:#666">=</span> df1<span style="color:#666">[</span>!, :col1<span style="color:#666">]</span> <span style="color:#408080;font-style:italic"># using ! here</span>
3-element Vector<span style="color:#666">{</span>Int64<span style="color:#666">}</span>:
 <span style="color:#666">1</span>
 <span style="color:#666">2</span>
 <span style="color:#666">3</span>

julia&gt; a<span style="color:#666">[</span>2<span style="color:#666">]</span> <span style="color:#666">=</span> <span style="color:#666">99</span>
<span style="color:#666">99</span>

julia&gt; <span style="color:#19177c">b</span> <span style="color:#666">=</span> df1<span style="color:#666">[</span>:, :col2<span style="color:#666">]</span> <span style="color:#408080;font-style:italic"># using : here</span>
3-element Vector<span style="color:#666">{</span>Char<span style="color:#666">}</span>:
 <span style="color:#ba2121">&#39;a&#39;</span>: ASCII/Unicode U+0061 <span style="color:#666">(</span>category Ll: Letter, lowercase<span style="color:#666">)</span>
 <span style="color:#ba2121">&#39;b&#39;</span>: ASCII/Unicode U+0062 <span style="color:#666">(</span>category Ll: Letter, lowercase<span style="color:#666">)</span>
 <span style="color:#ba2121">&#39;c&#39;</span>: ASCII/Unicode U+0063 <span style="color:#666">(</span>category Ll: Letter, lowercase<span style="color:#666">)</span>

julia&gt; b<span style="color:#666">[</span>2<span style="color:#666">]</span> <span style="color:#666">=</span> <span style="color:#ba2121">&#39;d&#39;</span>
<span style="color:#ba2121">&#39;d&#39;</span>: ASCII/Unicode U+0064 <span style="color:#666">(</span>category Ll: Letter, lowercase<span style="color:#666">)</span>

julia&gt; df1
3×2 DataFrame
 Row │ col1   col2 
     │ Int64  Char 
─────┼─────────────
   <span style="color:#666">1</span> │     <span style="color:#666">1</span>  a
   <span style="color:#666">2</span> │    <span style="color:#666">99</span>  b
   <span style="color:#666">3</span> │     <span style="color:#666">3</span>  c
</code></pre></div><p>As you can see, <code>col1</code> is mutated but <code>col2</code> is not.</p>
<p>Think about it: if you run <code>a = [4, 5, 6]</code> instead of <code>a[2] = 99</code>, will <code>df1</code> be modified as well? Why or why not?</p>
<p>The answer is no. <code>df1</code> won&rsquo;t change. This is because with <code>a = [4, 5, 6]</code>, you are reassigning <code>a</code>. This re-assignment has no effect on <code>df1</code> itself.</p>
<p>Also, if you run <code>a = df1[!, :col1][[2,2,3]]</code> and then <code>a[2]=99</code>, will <code>df1</code> be mutated?</p>
<p>The answer is also no. This is because, with <code>df1[!, :col1][[2,2,3]</code>, you are creating a new array based on <code>df1[!, col1]</code>. Then, with <code>a[22]=99</code>, you are mutating the new array, not <code>df1[!, col1]</code>.</p>
<p>You can check out <a href="https://stackoverflow.com/a/51336360/13716814" target="_blank" rel="noreferrer noopener">abarnert&rsquo;s answer</a>

. It is about Python, not Julia, but the logic is similar.</p>
<h2 id="updating-columns">Updating column(s)<a href="#updating-columns" class="header-anchor" ariaLabel="Anchor"> # </a></h2>
<p>When <code>df[!, col(s)]</code> or <code>df[:, col(s)]</code> are on the left side of the equal sign <code>=</code>, you are updating columns.</p>
<p>When you update column(s), whether you use <code>!</code> or <code>:</code>, <code>df</code> will be mutated. However, how <code>df</code> is mutated is different. <code>!</code> will create new column(s) to replace the old one(s). Only the updated column will be shown but the old one will be stored in memory. By contrast, <code>:</code> will update the values in-place.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia">a <span style="color:#666">=</span> [<span style="color:#ba2121">&#34;Tom&#34;</span>, <span style="color:#ba2121">&#34;Mike&#34;</span>, <span style="color:#ba2121">&#34;John&#34;</span>, <span style="color:#ba2121">&#34;Jason&#34;</span>, <span style="color:#ba2121">&#34;Bob&#34;</span>]
b <span style="color:#666">=</span> [<span style="color:#008000">missing</span>, <span style="color:#666">2</span>, <span style="color:#666">3</span>, <span style="color:#008000">missing</span>, <span style="color:#666">8</span>]
c <span style="color:#666">=</span> [<span style="color:#666">1</span>, <span style="color:#666">3</span>, <span style="color:#008000">missing</span>, <span style="color:#666">6</span>, <span style="color:#008000">missing</span>]
df <span style="color:#666">=</span> DataFrame(<span style="color:#19177c">:Name</span> <span style="color:#666">=&gt;</span> a, <span style="color:#19177c">:Var1</span> <span style="color:#666">=&gt;</span> b, <span style="color:#19177c">:Var2</span> <span style="color:#666">=&gt;</span> c)
</code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">julia&gt; df

5×3 DataFrame
 Row │ Name    Var1     Var2    
     │ String  Int64?   Int64?  
─────┼──────────────────────────
   <span style="color:#666">1</span> │ Tom     missing        <span style="color:#666">1</span>
   <span style="color:#666">2</span> │ Mike          <span style="color:#666">2</span>        <span style="color:#666">3</span>
   <span style="color:#666">3</span> │ John          <span style="color:#666">3</span>  missing 
   <span style="color:#666">4</span> │ Jason   missing        <span style="color:#666">6</span>
   <span style="color:#666">5</span> │ Bob           <span style="color:#666">8</span>  missing 
</code></pre></div><p>See how <code>!</code> will mutate the source:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">julia&gt;df <span style="color:#666">=</span> DataFrame<span style="color:#666">(</span>:Name <span style="color:#666">=</span>&gt; a, :Var1 <span style="color:#666">=</span>&gt; b, :Var2 <span style="color:#666">=</span>&gt; c<span style="color:#666">)</span>

julia&gt; df<span style="color:#666">[</span>!, :Var1<span style="color:#666">]</span> <span style="color:#666">=</span> collect<span style="color:#666">(</span>1:5<span style="color:#666">)</span>
5-element Vector<span style="color:#666">{</span>Int64<span style="color:#666">}</span>:
 <span style="color:#666">1</span>
 <span style="color:#666">2</span>
 <span style="color:#666">3</span>
 <span style="color:#666">4</span>
 <span style="color:#666">5</span>

julia&gt; df
5×3 DataFrame
 Row │ Name    Var1   Var2    
     │ String  Int64  Int64?  
─────┼────────────────────────
   <span style="color:#666">1</span> │ Tom         <span style="color:#666">1</span>        <span style="color:#666">1</span>
   <span style="color:#666">2</span> │ Mike        <span style="color:#666">2</span>        <span style="color:#666">3</span>
   <span style="color:#666">3</span> │ John        <span style="color:#666">3</span>  missing 
   <span style="color:#666">4</span> │ Jason       <span style="color:#666">4</span>        <span style="color:#666">6</span>
   <span style="color:#666">5</span> │ Bob         <span style="color:#666">5</span>  missing 

julia&gt; typeof<span style="color:#666">(</span>df.Var1<span style="color:#666">)</span>
Vector<span style="color:#666">{</span>Int64<span style="color:#666">}</span> <span style="color:#666">(</span><span style="color:#008000">alias</span> <span style="color:#008000;font-weight:bold">for</span> Array<span style="color:#666">{</span>Int64, 1<span style="color:#666">})</span>
</code></pre></div><p>You&rsquo;ll see a slightly different result when using <code>:</code>.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">julia&gt;df <span style="color:#666">=</span> DataFrame<span style="color:#666">(</span>:Name <span style="color:#666">=</span>&gt; a, :Var1 <span style="color:#666">=</span>&gt; b, :Var2 <span style="color:#666">=</span>&gt; c<span style="color:#666">)</span>

julia&gt; df<span style="color:#666">[</span>:, :Var1<span style="color:#666">]</span> <span style="color:#666">=</span> collect<span style="color:#666">(</span>1:5<span style="color:#666">)</span> 
5-element Vector<span style="color:#666">{</span>Int64<span style="color:#666">}</span>:
 <span style="color:#666">1</span>
 <span style="color:#666">2</span>
 <span style="color:#666">3</span>
 <span style="color:#666">4</span>
 <span style="color:#666">5</span>

julia&gt; df
5×3 DataFrame
 Row │ Name    Var1    Var2    
     │ String  Int64?  Int64?  
─────┼─────────────────────────
   <span style="color:#666">1</span> │ Tom          <span style="color:#666">1</span>        <span style="color:#666">1</span>
   <span style="color:#666">2</span> │ Mike         <span style="color:#666">2</span>        <span style="color:#666">3</span>
   <span style="color:#666">3</span> │ John         <span style="color:#666">3</span>  missing 
   <span style="color:#666">4</span> │ Jason        <span style="color:#666">4</span>        <span style="color:#666">6</span>
   <span style="color:#666">5</span> │ Bob          <span style="color:#666">5</span>  missing 

julia&gt; typeof<span style="color:#666">(</span>df.Var1<span style="color:#666">)</span>
Vector<span style="color:#666">{</span>Union<span style="color:#666">{</span>Missing, Int64<span style="color:#666">}}</span> <span style="color:#666">(</span><span style="color:#008000">alias</span> <span style="color:#008000;font-weight:bold">for</span> Array<span style="color:#666">{</span>Union<span style="color:#666">{</span>Missing, Int64<span style="color:#666">}</span>, 1<span style="color:#666">})</span>

</code></pre></div><p>Why do we have this difference in <code>typeof(df.Var1)</code>?</p>
<p>The explanation can be found in <a href="https://bkamins.github.io/julialang/2021/01/30/bang.html" target="_blank" rel="noreferrer noopener">Bogumił Kamiński&rsquo;s post</a>

:</p>
<blockquote>
<p>[U]sing <code>!</code> puts a new column passed on the right hand side to the data frame without copying it (no matter if the column exists or not in the data frame), while <code>:</code> assigns to an existing column in-place.</p>
</blockquote>
<p>Updating multiple columns is the same as updating a single column. The difference is that, to update multiple columns, you need a matrix or a data frame (I don&rsquo;t know how you can update multiple columns with a data frame, though).</p>
<p>Using <code>!</code>:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia">df <span style="color:#666">=</span> DataFrame(<span style="color:#19177c">:Name</span> <span style="color:#666">=&gt;</span> a, <span style="color:#19177c">:Var1</span> <span style="color:#666">=&gt;</span> b, <span style="color:#19177c">:Var2</span> <span style="color:#666">=&gt;</span> c)
matrixA <span style="color:#666">=</span> [<span style="color:#666">1</span> <span style="color:#666">2</span>; <span style="color:#666">3</span> <span style="color:#666">4</span>; <span style="color:#666">5</span> <span style="color:#666">6</span>; <span style="color:#666">7</span> <span style="color:#666">8</span>; <span style="color:#666">9</span> <span style="color:#666">10</span> ] <span style="color:#408080;font-style:italic"># This creates a 5×2 array</span>
df[<span style="color:#666">!</span>, [<span style="color:#19177c">:Var1</span>, <span style="color:#19177c">:Var2</span>]] <span style="color:#666">=</span> matrixA
</code></pre></div><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">julia&gt; df

5×3 DataFrame
 Row │ Name    Var1   Var2  
     │ String  Int64  Int64 
─────┼──────────────────────
   <span style="color:#666">1</span> │ Tom         <span style="color:#666">1</span>      <span style="color:#666">2</span>
   <span style="color:#666">2</span> │ Mike        <span style="color:#666">3</span>      <span style="color:#666">4</span>
   <span style="color:#666">3</span> │ John        <span style="color:#666">5</span>      <span style="color:#666">6</span>
   <span style="color:#666">4</span> │ Jason       <span style="color:#666">7</span>      <span style="color:#666">8</span>
   <span style="color:#666">5</span> │ Bob         <span style="color:#666">9</span>     <span style="color:#666">10</span>
</code></pre></div><p><div class="note">
Bogumił Kamiński wrote in <a href="https://bkamins.github.io/julialang/2021/01/30/bang#summary-of-the-cases" target="_blank" rel="noreferrer noopener">his summary</a>

 that when updating a single column, <code>!</code> will replace the column without copying. By contrast, when updating multiple columns, <code>!</code> will replace the columns with copying.</p>
<p>I don&rsquo;t know what the difference between &ldquo;with copying&rdquo; and &ldquo;without copying&rdquo; is.
</div></p>
<p>Using <code>:</code>:</p>
<pre tabindex="0"><code>df = DataFrame(:Name =&gt; a, :Var1 =&gt; b, :Var2 =&gt; c)
matrixA = [1 2; 3 4; 5 6; 7 8; 9 10 ] 
df[:, [:Var1, :Var2]] = matrixA
</code></pre><div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">julia&gt; df

5×3 DataFrame
 Row │ Name    Var1    Var2   
     │ String  Int64?  Int64? 
─────┼────────────────────────
   <span style="color:#666">1</span> │ Tom          <span style="color:#666">1</span>       <span style="color:#666">2</span>
   <span style="color:#666">2</span> │ Mike         <span style="color:#666">3</span>       <span style="color:#666">4</span>
   <span style="color:#666">3</span> │ John         <span style="color:#666">5</span>       <span style="color:#666">6</span>
   <span style="color:#666">4</span> │ Jason        <span style="color:#666">7</span>       <span style="color:#666">8</span>
   <span style="color:#666">5</span> │ Bob          <span style="color:#666">9</span>      <span style="color:#666">10</span>
</code></pre></div><h3 id="so-how-in-place-changes-are-different-from-creating-and-replacing">So, how in-place changes are different from creating and replacing?<a href="#so-how-in-place-changes-are-different-from-creating-and-replacing" class="header-anchor" ariaLabel="Anchor"> # </a></h3>
<p>The following example is taken from <a href="https://bkamins.github.io/julialang/2021/01/30/bang.html" target="_blank" rel="noreferrer noopener">Bogumił Kamiński&rsquo;s post</a>

.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">julia&gt; <span style="color:#19177c">df1</span> <span style="color:#666">=</span> DataFrame<span style="color:#666">(</span><span style="color:#19177c">col1</span><span style="color:#666">=</span>1:3, <span style="color:#19177c">col2</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;a&#39;</span>:<span style="color:#ba2121">&#39;c&#39;</span><span style="color:#666">)</span>
3×2 DataFrame
 Row │ col1   col2 
     │ Int64  Char 
─────┼─────────────
   <span style="color:#666">1</span> │     <span style="color:#666">1</span>  a
   <span style="color:#666">2</span> │     <span style="color:#666">2</span>  b
   <span style="color:#666">3</span> │     <span style="color:#666">3</span>  c

julia&gt; <span style="color:#19177c">col1</span> <span style="color:#666">=</span> df1.col1
3-element Array<span style="color:#666">{</span>Int64,1<span style="color:#666">}</span>:
 <span style="color:#666">1</span>
 <span style="color:#666">2</span>
 <span style="color:#666">3</span>

julia&gt; <span style="color:#19177c">v</span> <span style="color:#666">=</span> <span style="color:#666">[</span>11, 13, 13<span style="color:#666">]</span>
3-element Array<span style="color:#666">{</span>Int64,1<span style="color:#666">}</span>:
 <span style="color:#666">11</span>
 <span style="color:#666">13</span>
 <span style="color:#666">13</span>

julia&gt; df1<span style="color:#666">[</span>!, :col1<span style="color:#666">]</span> <span style="color:#666">=</span> v <span style="color:#408080;font-style:italic"># Using ! here</span>
3-element Array<span style="color:#666">{</span>Int64,1<span style="color:#666">}</span>:
 <span style="color:#666">11</span>
 <span style="color:#666">13</span>
 <span style="color:#666">13</span>
</code></pre></div><p>Take a break here. Guess what the result of <code>col1</code> and  <code>df2.col1</code> will be.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">julia&gt; col1
3-element Array<span style="color:#666">{</span>Int64,1<span style="color:#666">}</span>:
 <span style="color:#666">1</span>
 <span style="color:#666">2</span>
 <span style="color:#666">3</span>

julia&gt; df1.col1
3-element Array<span style="color:#666">{</span>Int64,1<span style="color:#666">}</span>:
 <span style="color:#666">11</span>
 <span style="color:#666">13</span>
 <span style="color:#666">13</span>
</code></pre></div><p>Okay. Let&rsquo;s see what the results will be if we use <code>:</code>.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">julia&gt; <span style="color:#19177c">df1</span> <span style="color:#666">=</span> DataFrame<span style="color:#666">(</span><span style="color:#19177c">col1</span><span style="color:#666">=</span>1:3, <span style="color:#19177c">col2</span><span style="color:#666">=</span><span style="color:#ba2121">&#39;a&#39;</span>:<span style="color:#ba2121">&#39;c&#39;</span><span style="color:#666">)</span>
3×2 DataFrame
 Row │ col1   col2 
     │ Int64  Char 
─────┼─────────────
   <span style="color:#666">1</span> │     <span style="color:#666">1</span>  a
   <span style="color:#666">2</span> │     <span style="color:#666">2</span>  b
   <span style="color:#666">3</span> │     <span style="color:#666">3</span>  c

julia&gt; <span style="color:#19177c">col1</span> <span style="color:#666">=</span> df1.col1
3-element Array<span style="color:#666">{</span>Int64,1<span style="color:#666">}</span>:
 <span style="color:#666">1</span>
 <span style="color:#666">2</span>
 <span style="color:#666">3</span>

julia&gt; <span style="color:#19177c">v</span> <span style="color:#666">=</span> <span style="color:#666">[</span>11, 13, 13<span style="color:#666">]</span>
3-element Array<span style="color:#666">{</span>Int64,1<span style="color:#666">}</span>:
 <span style="color:#666">11</span>
 <span style="color:#666">13</span>
 <span style="color:#666">13</span>

julia&gt; df1<span style="color:#666">[</span>:, :col1<span style="color:#666">]</span> <span style="color:#666">=</span> v <span style="color:#408080;font-style:italic"># Using : here</span>
3-element Array<span style="color:#666">{</span>Int64,1<span style="color:#666">}</span>:
 <span style="color:#666">11</span>
 <span style="color:#666">13</span>
 <span style="color:#666">13</span>
</code></pre></div><p>See the results:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">julia&gt; col1
3-element Array<span style="color:#666">{</span>Int64,1<span style="color:#666">}</span>:
 <span style="color:#666">11</span>
 <span style="color:#666">12</span>
 <span style="color:#666">13</span>

julia&gt; df1.col1
3-element Array<span style="color:#666">{</span>Int64,1<span style="color:#666">}</span>:
 <span style="color:#666">11</span>
 <span style="color:#666">13</span>
 <span style="color:#666">13</span>
</code></pre></div><p>Why is it that when we use <code>df1[!, :col1] = v</code>, <code>col1 = [1,2,3]</code> but when use <code>df1[:, :col1] = v</code>, <code>col1 = [11,12,13]</code>?</p>
<p>This is because <code>df1[!, :col1] = v</code> will first generate a new column and then use that to replace the old one. By contrast, <code>df1[:, :col1] = v</code> directly modifies the existing column. Therefore, when using <code>!</code>, you will have two <code>col1</code>s: the old one and the updated one. Only the updated one will be shown but the old one is stored in memory. That is why <code>col1</code> will get the old column of <code>col1</code> in <code>df1</code> whereas the <code>df1.col1</code> will get the updated one. When you use <code>:</code>, there is only one <code>col1</code>, i.e., the updated one. The old one is erased from memory. Therefore, <code>col1</code> will give you only the updated data.</p>
<p><div class="tip">
Read <a href="https://stackoverflow.com/a/38602012/13716814" target="_blank" rel="noreferrer noopener">@Chris Rackauckas&rsquo;s answer</a>

 to the question of <a href="https://stackoverflow.com/q/38601141/13716814" target="_blank" rel="noreferrer noopener"><em>What is the difference between “==” and “===” comparison operators in Julia?</em></a>

 on Stack Overflow to get a deeper understanding of this difference.
</div></p>
<h4 id="homework">Homework<a href="#homework" class="header-anchor" ariaLabel="Anchor"> # </a></h4>
<p>Change <code>col1 = df1.col1</code> to <code>col1 = df1[:, col1]</code>, and see whether <code>!</code> and <code>:</code> still generate different results.</p>
<p>The answer is that when <code>col1 = df1[:, col1]</code>, whether you run <code>df1[!, :col1] = v</code> or <code>df1[:, :col1] = v</code>, <code>col1</code> will always return <code>[1,2,3]</code>.</p>
<p>This is because if you use <code>col1 = df1[:, col]</code>, <code>col1</code> will be a copy of <code>df1.col1</code>. Therefore, whatever changes you make to <code>df1</code>, <code>col1</code> stays unchanged.</p>
<h3 id="broadcasting">Broadcasting<a href="#broadcasting" class="header-anchor" ariaLabel="Anchor"> # </a></h3>
<p>A special way to update column(s) is through <a href="https://dataframes.juliadata.org/stable/lib/indexing/#Broadcasting" target="_blank" rel="noreferrer noopener"><strong>broadcasting</strong></a>

.</p>
<p>You&rsquo;ll need <a href="https://docs.julialang.org/en/v1/manual/functions/#man-vectorized" target="_blank" rel="noreferrer noopener">Dot Syntax</a>

 to get broadcasting to work. What Dot Syntax does is to apply a function to each element in an array and then to return a new array.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">julia&gt; <span style="color:#19177c">df</span> <span style="color:#666">=</span> DataFrame<span style="color:#666">(</span>:Name <span style="color:#666">=</span>&gt; a, :Var1 <span style="color:#666">=</span>&gt; b, :Var2 <span style="color:#666">=</span>&gt; c<span style="color:#666">)</span>

julia&gt; df<span style="color:#666">[</span>!, :Name<span style="color:#666">]</span> .<span style="color:#666">=</span> <span style="color:#ba2121">&#34;Johnson&#34;</span>

julia&gt; df<span style="color:#666">[</span>!, <span style="color:#666">[</span>:Var1, :Var2<span style="color:#666">]]</span> .<span style="color:#666">=</span> <span style="color:#666">99</span>

julia&gt; df

5×3 DataFrame
 Row │ Name     Var1   Var2  
     │ String   Int64  Int64 
─────┼───────────────────────
   <span style="color:#666">1</span> │ Johnson     <span style="color:#666">99</span>     <span style="color:#666">99</span>
   <span style="color:#666">2</span> │ Johnson     <span style="color:#666">99</span>     <span style="color:#666">99</span>
   <span style="color:#666">3</span> │ Johnson     <span style="color:#666">99</span>     <span style="color:#666">99</span>
   <span style="color:#666">4</span> │ Johnson     <span style="color:#666">99</span>     <span style="color:#666">99</span>
   <span style="color:#666">5</span> │ Johnson     <span style="color:#666">99</span>     <span style="color:#666">99</span>
</code></pre></div><p><div class="tip">
Note that in broadcasting, there cannot exist space between <code>.</code> and <code>=</code>; otherwise, you will see an error.
</div></p>
<p>Both <code>!</code> and <code>:</code> work in broadcasting. As with non-broadcasting methods to update column(s), <code>!</code> first creates new column(s) to replace the old one(s) whereas <code>:</code> updates the column(s) in-place.</p>
<p>Please note that there is a restriction when updating column(s) with <code>:</code> through broadcasting: the type of object has to be the same as the one you are updating. Otherwise, you will see an error:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">julia&gt; <span style="color:#19177c">df</span> <span style="color:#666">=</span> DataFrame<span style="color:#666">(</span>:Name <span style="color:#666">=</span>&gt; a, :Var1 <span style="color:#666">=</span>&gt; b, :Var2 <span style="color:#666">=</span>&gt; c<span style="color:#666">)</span>

julia&gt; df<span style="color:#666">[</span>:, :Var1<span style="color:#666">]</span> .<span style="color:#666">=</span> <span style="color:#ba2121">&#34;A&#34;</span>
ERROR: MethodError: Cannot <span style="color:#ba2121">`</span>convert<span style="color:#ba2121">`</span> an object of <span style="color:#008000">type</span> String to an object of <span style="color:#008000">type</span> Int64
</code></pre></div><p>The same error occurs if you use <code>df.Var1 .= &quot;A&quot;</code>. However, <code>df[!, :Var1] .= &quot;A&quot;</code> will work because it creates a new column to replace the old one.</p>
<p><div class="note">
One thing I don&rsquo;t understand is that if I replace <code>&quot;A&quot;</code> with <code>'a'</code>, there won&rsquo;t be an error, and all the values are updated to be <code>65</code>.
</div></p>
<p>Another thing I don&rsquo;t understand is that <code>df[!, [:Var1, :Var2]] .= 99</code> will return the whole data frame whereas <code>df[:, [:Var1, :Var2]] .= 99</code> returns only the selected two columns:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">julia&gt; <span style="color:#19177c">df</span> <span style="color:#666">=</span> DataFrame<span style="color:#666">(</span>:Name <span style="color:#666">=</span>&gt; a, :Var1 <span style="color:#666">=</span>&gt; b, :Var2 <span style="color:#666">=</span>&gt; c<span style="color:#666">)</span>

julia&gt; df<span style="color:#666">[</span>!, <span style="color:#666">[</span>:Var1, :Var2<span style="color:#666">]]</span> .<span style="color:#666">=</span> <span style="color:#666">99</span>

5×3 DataFrame
 Row │ Name    Var1   Var2  
     │ String  Int64  Int64 
─────┼──────────────────────
   <span style="color:#666">1</span> │ Tom        <span style="color:#666">99</span>     <span style="color:#666">99</span>
   <span style="color:#666">2</span> │ Mike       <span style="color:#666">99</span>     <span style="color:#666">99</span>
   <span style="color:#666">3</span> │ John       <span style="color:#666">99</span>     <span style="color:#666">99</span>
   <span style="color:#666">4</span> │ Jason      <span style="color:#666">99</span>     <span style="color:#666">99</span>
   <span style="color:#666">5</span> │ Bob        <span style="color:#666">99</span>     <span style="color:#666">99</span>

julia&gt; df<span style="color:#666">[</span>:, <span style="color:#666">[</span>:Var1, :Var2<span style="color:#666">]]</span> .<span style="color:#666">=</span> <span style="color:#666">99</span>

5×2 SubDataFrame
 Row │ Var1   Var2  
     │ Int64  Int64 
─────┼──────────────
   <span style="color:#666">1</span> │    <span style="color:#666">99</span>     <span style="color:#666">99</span>
   <span style="color:#666">2</span> │    <span style="color:#666">99</span>     <span style="color:#666">99</span>
   <span style="color:#666">3</span> │    <span style="color:#666">99</span>     <span style="color:#666">99</span>
   <span style="color:#666">4</span> │    <span style="color:#666">99</span>     <span style="color:#666">99</span>
   <span style="color:#666">5</span> │    <span style="color:#666">99</span>     <span style="color:#666">99</span>
</code></pre></div><h3 id="updating-the-value-of-a-single-cell">Updating the value of a single cell<a href="#updating-the-value-of-a-single-cell" class="header-anchor" ariaLabel="Anchor"> # </a></h3>
<p>Updating a single cell is different from updating columns: When updating a single cell, <code>!</code> will change the source whereas <code>:</code> won&rsquo;t.</p>
<p>This is essentially the same as <a href="/en/2021/07/05/julia-bang/#accessing-columns"># accessing columns</a>

.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">julia&gt; <span style="color:#19177c">df</span> <span style="color:#666">=</span> DataFrame<span style="color:#666">(</span>:Name <span style="color:#666">=</span>&gt; a, :Var1 <span style="color:#666">=</span>&gt; b, :Var2 <span style="color:#666">=</span>&gt; c<span style="color:#666">)</span>

julia&gt; df<span style="color:#666">[</span>!, :Var1<span style="color:#666">][</span>2<span style="color:#666">]</span> <span style="color:#666">=</span> <span style="color:#666">99</span>
<span style="color:#666">99</span>

julia&gt; df<span style="color:#666">[</span>:, :Var2<span style="color:#666">][</span>2<span style="color:#666">]</span> <span style="color:#666">=</span> <span style="color:#666">99</span>
<span style="color:#666">99</span>

julia&gt; df
5×3 DataFrame
 Row │ Name    Var1     Var2    
     │ String  Int64?   Int64?  
─────┼──────────────────────────
   <span style="color:#666">1</span> │ Tom     missing        <span style="color:#666">1</span>
   <span style="color:#666">2</span> │ Mike         <span style="color:#666">99</span>        <span style="color:#666">3</span>
   <span style="color:#666">3</span> │ John          <span style="color:#666">3</span>  missing 
   <span style="color:#666">4</span> │ Jason   missing        <span style="color:#666">6</span>
   <span style="color:#666">5</span> │ Bob           <span style="color:#666">8</span>  missing 
</code></pre></div><p>Note that no matter whether you use <code>:</code> or <code>!</code>, you are <a href="https://github.com/JuliaData/DataFrames.jl/issues/2816" target="_blank" rel="noreferrer noopener">not allowed to change the cell&rsquo;s value to a different type</a>

. For example, if you run <code>df[!, :Var1][2] = &quot;Good&quot;</code>, you&rsquo;ll see an error:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">MethodError: Cannot <span style="color:#ba2121">`</span>convert<span style="color:#ba2121">`</span> an object of <span style="color:#008000">type</span> String to an object of <span style="color:#008000">type</span> Int64
</code></pre></div><p>To force this conversion, you have to convert column data type first:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-julia" data-lang="julia">typeof(df[<span style="color:#666">!</span>, <span style="color:#19177c">:Var1</span>]) 
<span style="color:#408080;font-style:italic"># Returns Vector{Union{Missing, Int64}} (alias for Array{Union{Missing, Int64}, 1}</span>
df[<span style="color:#666">!</span>, <span style="color:#19177c">:Var1</span>] <span style="color:#666">=</span> string<span style="color:#666">.</span>(df[<span style="color:#666">!</span>, <span style="color:#19177c">:Var1</span>])
typeof(df[<span style="color:#666">!</span>, <span style="color:#19177c">:Var1</span>]) <span style="color:#408080;font-style:italic"># Returns Vector{String} (alias for Array{String, 1})</span>
<span style="color:#408080;font-style:italic"># Now you can change the value of the cell</span>
df[<span style="color:#666">:</span>, <span style="color:#19177c">:Var1</span>][<span style="color:#666">2</span>] <span style="color:#666">=</span> <span style="color:#ba2121">&#34;Good&#34;</span>
</code></pre></div><p>Reference: <a href="https://discourse.julialang.org/t/dataframes-convert-column-data-type/35522" target="_blank" rel="noreferrer noopener">DataFrames: convert column data type</a>

</p>
<p>Or, you can use <a href="https://docs.julialang.org/en/v1/base/base/#Core.ifelse" target="_blank" rel="noreferrer noopener"><code>Core.ifelse</code></a>

 as <a href="https://github.com/JuliaData/DataFrames.jl/issues/2816#issuecomment-880233095" target="_blank" rel="noreferrer noopener">@bkamins recommended</a>

:</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">julia&gt; <span style="color:#19177c">df</span> <span style="color:#666">=</span> DataFrame<span style="color:#666">(</span>:Name <span style="color:#666">=</span>&gt; a, :Var1 <span style="color:#666">=</span>&gt; b, :Var2 <span style="color:#666">=</span>&gt; c<span style="color:#666">)</span>
5×3 DataFrame
 Row │ Name    Var1     Var2    
     │ String  Int64?   Int64?  
─────┼──────────────────────────
   <span style="color:#666">1</span> │ Tom     missing        <span style="color:#666">1</span>
   <span style="color:#666">2</span> │ Mike          <span style="color:#666">2</span>        <span style="color:#666">3</span>
   <span style="color:#666">3</span> │ John          <span style="color:#666">3</span>  missing 
   <span style="color:#666">4</span> │ Jason   missing        <span style="color:#666">6</span>
   <span style="color:#666">5</span> │ Bob           <span style="color:#666">8</span>  missing 

julia&gt; df.Var1 <span style="color:#666">=</span> ifelse.<span style="color:#666">(</span>axes<span style="color:#666">(</span>df.Var1, 1<span style="color:#666">)</span> .<span style="color:#666">==</span> 2, <span style="color:#ba2121">&#34;Good&#34;</span>, df.Var1<span style="color:#666">)</span> <span style="color:#408080;font-style:italic"># 2 is index, not value</span>
5-element Vector<span style="color:#666">{</span>Any<span style="color:#666">}</span>:
  missing
  <span style="color:#ba2121">&#34;Good&#34;</span>
 <span style="color:#666">3</span>
  missing
 <span style="color:#666">8</span>

julia&gt; df
5×3 DataFrame
 Row │ Name    Var1     Var2    
     │ String  Any      Int64?  
─────┼──────────────────────────
   <span style="color:#666">1</span> │ Tom     missing        <span style="color:#666">1</span>
   <span style="color:#666">2</span> │ Mike    Good           <span style="color:#666">3</span>
   <span style="color:#666">3</span> │ John    <span style="color:#666">3</span>        missing 
   <span style="color:#666">4</span> │ Jason   missing        <span style="color:#666">6</span>
   <span style="color:#666">5</span> │ Bob     <span style="color:#666">8</span>        missing 
</code></pre></div><h2 id="adding-a-column">Adding a column<a href="#adding-a-column" class="header-anchor" ariaLabel="Anchor"> # </a></h2>
<p>In <code>df[!, col] = </code> or <code>df[:, col] = </code>, if <code>col</code> is not present in <code>df</code>, then a new column will be added.</p>
<div class="highlight"><pre tabindex="0" style=";-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">julia&gt; <span style="color:#19177c">df</span> <span style="color:#666">=</span> DataFrame<span style="color:#666">(</span>:Name <span style="color:#666">=</span>&gt; a, :Var1 <span style="color:#666">=</span>&gt; b, :Var2 <span style="color:#666">=</span>&gt; c<span style="color:#666">)</span>

julia&gt; df<span style="color:#666">[</span>!, :Var3<span style="color:#666">]</span> <span style="color:#666">=</span> collect<span style="color:#666">(</span>11:15<span style="color:#666">)</span>

julia&gt; df<span style="color:#666">[</span>:, :Var4<span style="color:#666">]</span> <span style="color:#666">=</span> collect<span style="color:#666">(</span><span style="color:#ba2121">&#39;e&#39;</span>:<span style="color:#ba2121">&#39;i&#39;</span><span style="color:#666">)</span>

julia&gt; df<span style="color:#666">[</span>!, :Var5<span style="color:#666">]</span> .<span style="color:#666">=</span> <span style="color:#666">99</span> <span style="color:#408080;font-style:italic"># Broadcasting</span>

julia&gt; df<span style="color:#666">[</span>:, :Var6<span style="color:#666">]</span> .<span style="color:#666">=</span> <span style="color:#ba2121">&#39;t&#39;</span> <span style="color:#408080;font-style:italic"># Broadcasting</span>

julia&gt; df

5×7 DataFrame
 Row │ Name    Var1     Var2     Var3   Var4  Var5   Var6 
     │ String  Int64?   Int64?   Int64  Char  Int64  Char 
─────┼────────────────────────────────────────────────────
   <span style="color:#666">1</span> │ Tom     missing        <span style="color:#666">1</span>     <span style="color:#666">11</span>  e        <span style="color:#666">99</span>  t
   <span style="color:#666">2</span> │ Mike          <span style="color:#666">2</span>        <span style="color:#666">3</span>     <span style="color:#666">12</span>  f        <span style="color:#666">99</span>  t
   <span style="color:#666">3</span> │ John          <span style="color:#666">3</span>  missing     <span style="color:#666">13</span>  g        <span style="color:#666">99</span>  t
   <span style="color:#666">4</span> │ Jason   missing        <span style="color:#666">6</span>     <span style="color:#666">14</span>  h        <span style="color:#666">99</span>  t
   <span style="color:#666">5</span> │ Bob           <span style="color:#666">8</span>  missing     <span style="color:#666">15</span>  i        <span style="color:#666">99</span>  t
</code></pre></div><p>Note that it is <strong>IMPOSSIBLE</strong> to add multiple columns. For example, <code>df[!, [:Var7, :Var8]] .= 99</code> will throw an error.</p>
<h2 id="getproperty-or-dfcol"><code>getproperty</code>, or <code>df.col</code><a href="#getproperty-or-dfcol" class="header-anchor" ariaLabel="Anchor"> # </a></h2>
<p>I haven&rsquo;t talked about how <code>df.col</code> works. It pretty much does the same thing as <code>df[!, col]</code>, except:</p>
<ul>
<li>
<p><code>df.col</code> is only able to access a single column whereas <code>df[!, cols]</code> can access multiple ones;</p>
</li>
<li>
<p>Currently (under Julia v1.6.1 and DataFrames v1.2.0), it is not allowed to create a new column with <code>df.newcol</code> through broadcasting. This feature <a href="https://github.com/JuliaLang/julia/pull/39473" target="_blank" rel="noreferrer noopener">may be possible in future Julia releases</a>

;</p>
</li>
<li>
<p>When updating a column by broadcasting, <code>df.col</code>, like <code>df[:, col]</code>, modifies values in-place rather than creating a new column to replace the old one.</p>
</li>
</ul>
<h2 id="conclusion">Conclusion<a href="#conclusion" class="header-anchor" ariaLabel="Anchor"> # </a></h2>
<h3 id="a-table-summarizing-the-key-points">A table summarizing the key points<a href="#a-table-summarizing-the-key-points" class="header-anchor" ariaLabel="Anchor"> # </a></h3>
<table>
<thead>
<tr>
<th></th>
<th>df[!, col(s)]</th>
<th>df[:, col(s)]</th>
<th>df.col</th>
</tr>
</thead>
<tbody>
<tr>
<td>Access 1 col</td>
<td>direct reference to df</td>
<td>a copy of the col</td>
<td>direct reference</td>
</tr>
<tr>
<td>Access cols</td>
<td>direct reference</td>
<td>a copy of the cols</td>
<td>❌</td>
</tr>
<tr>
<td>Update 1 col with a vector</td>
<td>create a new column to replace the old one</td>
<td>modify values in-place</td>
<td>create and replace</td>
</tr>
<tr>
<td>Update cols with a matrix or df</td>
<td>create and replace</td>
<td>modify in-place</td>
<td>❌</td>
</tr>
<tr>
<td>Update 1 col with broadcasting</td>
<td>create and replace</td>
<td>modify in-place</td>
<td><em>modify in-place</em></td>
</tr>
<tr>
<td>Update cols with broadcasting</td>
<td>create and replace</td>
<td>modify in-place</td>
<td>❌</td>
</tr>
<tr>
<td>Add 1 col with a vector</td>
<td>create a new col</td>
<td>create a new col</td>
<td>create a new col</td>
</tr>
<tr>
<td>Add cols</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
<tr>
<td>Add 1 col with broadcasting</td>
<td>create a new col</td>
<td>create a new col</td>
<td>❌ (<a href="https://github.com/JuliaData/DataFrames.jl/issues/2804" target="_blank" rel="noreferrer noopener">available later</a>

)</td>
</tr>
<tr>
<td>Add cols with broadcasting</td>
<td>❌</td>
<td>❌</td>
<td>❌</td>
</tr>
</tbody>
</table>
<h3 id="best-practices">Best practices<a href="#best-practices" class="header-anchor" ariaLabel="Anchor"> # </a></h3>
<ul>
<li>
<p>It seems to me that the only situation where you have to use <code>!</code> instead of <code>:</code> is if you have values of a different type when updating column(s).</p>
</li>
<li>
<p>If you are accessing a column or columns <strong>directly</strong>, it&rsquo;s always better to use <code>:</code>, instead of <code>!</code>. For example, you are declaring a variable <code>a</code>: <code>a = df[!, col1]</code>. Later when you modify <code>a</code>, you might mutate <code>df</code> as well.</p>
<p>If you are accessing a column or columns <strong>indirectly</strong>, it&rsquo;s Okay, and desirable to use <code>df.col</code>, which is simpler. Examples of indirect access may be <code>a = first(df, 5).col1</code> or <code>a = filter(r -&gt; r.col1 == &quot;A&quot;, df).col2</code>. Both operations will get you a new data frame, so whatever you do with <code>a</code>, <code>df</code> won&rsquo;t be mutated. In these cases, <code>df.col</code> is much simpler.</p>
<p>When you are accessing a column or columns directly, there is one situation where you want to use <code>!</code> (or <code>df.col</code> if it&rsquo;s a single column). That is when you want to store the column(s) before you update that column(s). I have covered that point in the section of <a href="/en/2021/07/05/julia-bang/#so-how-in-place-changes-are-different-from-creating-and-replacing">So, how in-place changes are different from creating and replacing?</a>

.</p>
</li>
</ul>

<p style="color:#777;">Last modified on 2021-10-07</p>
</div>
<a href="#top"><i class="fa fa-chevron-up" style="font-size: 30px; color: black;"></i></a>

</main>

<footer class="footer">
<script src="https://utteranc.es/client.js"
        repo="hongtaoh/hongtaoh.github.io"
        issue-term="pathname"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script>
  <script type="text/javascript" src="/js/math-code.js"></script>
<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script type="text/javascript" src="/js/center-img.js"></script>



     <ul class="footer-links">
      
       
       
       
       <li><a href="/en/blog/index.xml" type="application/rss+xml" title="RSS feed">
       Subscribe </a>
       </li>
       
       
       <li>
       
        <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">
       
        License
        <i class="fa fa-cc" aria-hidden="true" title="Attribution-NonCommercial-ShareAlike 4.0 International"></i> 
        </a>
       </li>
       
     </ul>
     <div class="copyright-text">
            
            ©
            
            Hongtao Hao
            
            2020-2021
            
     </div>
</footer>





