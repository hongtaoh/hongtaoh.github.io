---

title: SQL 简易教程
date: 2024-10-05
author: 郝鸿涛
slug: sql
draft: false
toc: true
tags: 编程

---

说实话，平常我用不到 SQL，所以一直没有去学。因为要面试，在准备 SQL 方面的知识，就快速学习了一下。我的感觉是和 Pandas 没差多少。

我用的是苹果电脑，Windows 的会不太一样。

我选择用 [Sqlite](https://www.sqlite.org/)，因为这个最简单，不需要服务器。

首先检查 `sqlite3` 是否安装：

```sh
sqlite3 --version
```

我假设你已经安装了 Anaconda。接着，我们建一个虚拟环境

```sh
conda create --name sql
conda activate sql
conda install pandas jupyter ipython-sql 
```

然后创建一个文件夹

```sh
mkdir sql-learn
cd sql-learn 
```

下载两个文档：

```sh
curl -o sqlite.txt https://www.sqltutorial.org/wp-content/uploads/2020/04/sqlite.txt
curl -o sqlite-data.txt https://www.sqltutorial.org/wp-content/uploads/2020/04/sqlite-data.txt
```

如果你怕安全性有问题，我建议你把两个网址打开，确认是单纯的 `txt` 文档。

然后：

```sh
sqlite3 tutorial.db
```
接着

```sh
.read sqlite.txt
```

继续

```sh
.read sqlite-data.txt
```

检查一下

```sh
.tables
```

结果应该是

```sh
sqlite> .tables
countries    dependents   jobs         regions    
departments  employees    locations  
```

```sh
SELECT * FROM countries LIMIT 5;
```

结果应该是

```sh
sqlite> SELECT * FROM countries LIMIT 5;
AR|Argentina|2
AU|Australia|3
BE|Belgium|1
BR|Brazil|2
CA|Canada|2
```

如果没问题，就可以继续开始了。

我在 VS Code 里用 Jupyter Notebook。建一个 `ipynb` 文档，然后下面的都是在那里面操作。

本文严重参考 [https://www.sqltutorial.org/](https://www.sqltutorial.org/) 上的内容。

首先

```py
%load_ext sql
%sql sqlite:///tutorial.db
```

但是我这个博客里因为数据在别的地方，所以第二行会不一样：


```python
%load_ext sql
%config SqlMagic.displaycon = False
%sql sqlite:///../static/files/cnblog/sql-learn/tutorial.db
```

    The sql extension is already loaded. To reload it, use:
      %reload_ext sql


## All tables


```sql
%%sql
SELECT name FROM sqlite_master WHERE type='table';
```

    Done.





<table>
    <thead>
        <tr>
            <th>name</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>regions</td>
        </tr>
        <tr>
            <td>sqlite_sequence</td>
        </tr>
        <tr>
            <td>countries</td>
        </tr>
        <tr>
            <td>locations</td>
        </tr>
        <tr>
            <td>departments</td>
        </tr>
        <tr>
            <td>jobs</td>
        </tr>
        <tr>
            <td>employees</td>
        </tr>
        <tr>
            <td>dependents</td>
        </tr>
    </tbody>
</table>



## Query


```sql
%%sql
select * from locations limit 5
```

    Done.





<table>
    <thead>
        <tr>
            <th>location_id</th>
            <th>street_address</th>
            <th>postal_code</th>
            <th>city</th>
            <th>state_province</th>
            <th>country_id</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1400</td>
            <td>2014 Jabberwocky Rd</td>
            <td>26192</td>
            <td>Southlake</td>
            <td>Texas</td>
            <td>US</td>
        </tr>
        <tr>
            <td>1500</td>
            <td>2011 Interiors Blvd</td>
            <td>99236</td>
            <td>South San Francisco</td>
            <td>California</td>
            <td>US</td>
        </tr>
        <tr>
            <td>1700</td>
            <td>2004 Charade Rd</td>
            <td>98199</td>
            <td>Seattle</td>
            <td>Washington</td>
            <td>US</td>
        </tr>
        <tr>
            <td>1800</td>
            <td>147 Spadina Ave</td>
            <td>M5V 2L7</td>
            <td>Toronto</td>
            <td>Ontario</td>
            <td>CA</td>
        </tr>
        <tr>
            <td>2400</td>
            <td>8204 Arthur St</td>
            <td>None</td>
            <td>London</td>
            <td>None</td>
            <td>UK</td>
        </tr>
    </tbody>
</table>




```sql
%%sql 
select first_name, last_name from employees limit 10
```

    Done.





<table>
    <thead>
        <tr>
            <th>first_name</th>
            <th>last_name</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Steven</td>
            <td>King</td>
        </tr>
        <tr>
            <td>Neena</td>
            <td>Kochhar</td>
        </tr>
        <tr>
            <td>Lex</td>
            <td>De Haan</td>
        </tr>
        <tr>
            <td>Alexander</td>
            <td>Hunold</td>
        </tr>
        <tr>
            <td>Bruce</td>
            <td>Ernst</td>
        </tr>
        <tr>
            <td>David</td>
            <td>Austin</td>
        </tr>
        <tr>
            <td>Valli</td>
            <td>Pataballa</td>
        </tr>
        <tr>
            <td>Diana</td>
            <td>Lorentz</td>
        </tr>
        <tr>
            <td>Nancy</td>
            <td>Greenberg</td>
        </tr>
        <tr>
            <td>Daniel</td>
            <td>Faviet</td>
        </tr>
    </tbody>
</table>




```sql
%%sql
select employee_id, salary from employees where salary < 3000;
```

    Done.





<table>
    <thead>
        <tr>
            <th>employee_id</th>
            <th>salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>118</td>
            <td>2866.5</td>
        </tr>
        <tr>
            <td>119</td>
            <td>2756.25</td>
        </tr>
        <tr>
            <td>126</td>
            <td>2976.75</td>
        </tr>
    </tbody>
</table>




```python
# %%sql 
# delete from employees where hire_date < '1990-01-01';
```


```sql
%%sql 
select first_name, last_name, salary, salary * 1.5 
from employees limit 10;
```

    Done.





<table>
    <thead>
        <tr>
            <th>first_name</th>
            <th>last_name</th>
            <th>salary</th>
            <th>salary * 1.5</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Steven</td>
            <td>King</td>
            <td>24000.0</td>
            <td>36000.0</td>
        </tr>
        <tr>
            <td>Neena</td>
            <td>Kochhar</td>
            <td>17000.0</td>
            <td>25500.0</td>
        </tr>
        <tr>
            <td>Lex</td>
            <td>De Haan</td>
            <td>17000.0</td>
            <td>25500.0</td>
        </tr>
        <tr>
            <td>Alexander</td>
            <td>Hunold</td>
            <td>9000.0</td>
            <td>13500.0</td>
        </tr>
        <tr>
            <td>Bruce</td>
            <td>Ernst</td>
            <td>6000.0</td>
            <td>9000.0</td>
        </tr>
        <tr>
            <td>David</td>
            <td>Austin</td>
            <td>4800.0</td>
            <td>7200.0</td>
        </tr>
        <tr>
            <td>Valli</td>
            <td>Pataballa</td>
            <td>4800.0</td>
            <td>7200.0</td>
        </tr>
        <tr>
            <td>Diana</td>
            <td>Lorentz</td>
            <td>4200.0</td>
            <td>6300.0</td>
        </tr>
        <tr>
            <td>Nancy</td>
            <td>Greenberg</td>
            <td>12000.0</td>
            <td>18000.0</td>
        </tr>
        <tr>
            <td>Daniel</td>
            <td>Faviet</td>
            <td>9000.0</td>
            <td>13500.0</td>
        </tr>
    </tbody>
</table>




```sql
%%sql 
select 
    first_name, 
    last_name, 
    salary, 
    salary * 1.5 as new_salary 
from employees limit 10;
```

    Done.





<table>
    <thead>
        <tr>
            <th>first_name</th>
            <th>last_name</th>
            <th>salary</th>
            <th>new_salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Steven</td>
            <td>King</td>
            <td>24000.0</td>
            <td>36000.0</td>
        </tr>
        <tr>
            <td>Neena</td>
            <td>Kochhar</td>
            <td>17000.0</td>
            <td>25500.0</td>
        </tr>
        <tr>
            <td>Lex</td>
            <td>De Haan</td>
            <td>17000.0</td>
            <td>25500.0</td>
        </tr>
        <tr>
            <td>Alexander</td>
            <td>Hunold</td>
            <td>9000.0</td>
            <td>13500.0</td>
        </tr>
        <tr>
            <td>Bruce</td>
            <td>Ernst</td>
            <td>6000.0</td>
            <td>9000.0</td>
        </tr>
        <tr>
            <td>David</td>
            <td>Austin</td>
            <td>4800.0</td>
            <td>7200.0</td>
        </tr>
        <tr>
            <td>Valli</td>
            <td>Pataballa</td>
            <td>4800.0</td>
            <td>7200.0</td>
        </tr>
        <tr>
            <td>Diana</td>
            <td>Lorentz</td>
            <td>4200.0</td>
            <td>6300.0</td>
        </tr>
        <tr>
            <td>Nancy</td>
            <td>Greenberg</td>
            <td>12000.0</td>
            <td>18000.0</td>
        </tr>
        <tr>
            <td>Daniel</td>
            <td>Faviet</td>
            <td>9000.0</td>
            <td>13500.0</td>
        </tr>
    </tbody>
</table>



## Sort


```sql
%%sql 
select 
    employee_id,
    first_name,
    last_name,
    hire_date,
    salary 
from 
    employees
limit 
    10;
```

    Done.





<table>
    <thead>
        <tr>
            <th>employee_id</th>
            <th>first_name</th>
            <th>last_name</th>
            <th>hire_date</th>
            <th>salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>100</td>
            <td>Steven</td>
            <td>King</td>
            <td>1987-06-17</td>
            <td>24000.0</td>
        </tr>
        <tr>
            <td>101</td>
            <td>Neena</td>
            <td>Kochhar</td>
            <td>1989-09-21</td>
            <td>17000.0</td>
        </tr>
        <tr>
            <td>102</td>
            <td>Lex</td>
            <td>De Haan</td>
            <td>1993-01-13</td>
            <td>17000.0</td>
        </tr>
        <tr>
            <td>103</td>
            <td>Alexander</td>
            <td>Hunold</td>
            <td>1990-01-03</td>
            <td>9000.0</td>
        </tr>
        <tr>
            <td>104</td>
            <td>Bruce</td>
            <td>Ernst</td>
            <td>1991-05-21</td>
            <td>6000.0</td>
        </tr>
        <tr>
            <td>105</td>
            <td>David</td>
            <td>Austin</td>
            <td>1997-06-25</td>
            <td>4800.0</td>
        </tr>
        <tr>
            <td>106</td>
            <td>Valli</td>
            <td>Pataballa</td>
            <td>1998-02-05</td>
            <td>4800.0</td>
        </tr>
        <tr>
            <td>107</td>
            <td>Diana</td>
            <td>Lorentz</td>
            <td>1999-02-07</td>
            <td>4200.0</td>
        </tr>
        <tr>
            <td>108</td>
            <td>Nancy</td>
            <td>Greenberg</td>
            <td>1994-08-17</td>
            <td>12000.0</td>
        </tr>
        <tr>
            <td>109</td>
            <td>Daniel</td>
            <td>Faviet</td>
            <td>1994-08-16</td>
            <td>9000.0</td>
        </tr>
    </tbody>
</table>




```sql
%%sql 
select 
    employee_id,
    first_name,
    last_name,
    hire_date,
    salary 
from 
    employees
order by   
    first_name
limit 
    10;
```

    Done.





<table>
    <thead>
        <tr>
            <th>employee_id</th>
            <th>first_name</th>
            <th>last_name</th>
            <th>hire_date</th>
            <th>salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>121</td>
            <td>Adam</td>
            <td>Fripp</td>
            <td>1997-04-10</td>
            <td>8200.0</td>
        </tr>
        <tr>
            <td>103</td>
            <td>Alexander</td>
            <td>Hunold</td>
            <td>1990-01-03</td>
            <td>9000.0</td>
        </tr>
        <tr>
            <td>115</td>
            <td>Alexander</td>
            <td>Khoo</td>
            <td>1995-05-18</td>
            <td>3100.0</td>
        </tr>
        <tr>
            <td>193</td>
            <td>Britney</td>
            <td>Everett</td>
            <td>1997-03-03</td>
            <td>3900.0</td>
        </tr>
        <tr>
            <td>104</td>
            <td>Bruce</td>
            <td>Ernst</td>
            <td>1991-05-21</td>
            <td>6000.0</td>
        </tr>
        <tr>
            <td>179</td>
            <td>Charles</td>
            <td>Johnson</td>
            <td>2000-01-04</td>
            <td>6200.0</td>
        </tr>
        <tr>
            <td>109</td>
            <td>Daniel</td>
            <td>Faviet</td>
            <td>1994-08-16</td>
            <td>9000.0</td>
        </tr>
        <tr>
            <td>105</td>
            <td>David</td>
            <td>Austin</td>
            <td>1997-06-25</td>
            <td>4800.0</td>
        </tr>
        <tr>
            <td>114</td>
            <td>Den</td>
            <td>Raphaely</td>
            <td>1994-12-07</td>
            <td>11000.0</td>
        </tr>
        <tr>
            <td>107</td>
            <td>Diana</td>
            <td>Lorentz</td>
            <td>1999-02-07</td>
            <td>4200.0</td>
        </tr>
    </tbody>
</table>




```sql
%%sql 
select 
    employee_id,
    first_name,
    last_name,
    hire_date,
    salary 
from 
    employees
order by   
    first_name,
    last_name desc
limit 
    10;
```

    Done.





<table>
    <thead>
        <tr>
            <th>employee_id</th>
            <th>first_name</th>
            <th>last_name</th>
            <th>hire_date</th>
            <th>salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>121</td>
            <td>Adam</td>
            <td>Fripp</td>
            <td>1997-04-10</td>
            <td>8200.0</td>
        </tr>
        <tr>
            <td>115</td>
            <td>Alexander</td>
            <td>Khoo</td>
            <td>1995-05-18</td>
            <td>3100.0</td>
        </tr>
        <tr>
            <td>103</td>
            <td>Alexander</td>
            <td>Hunold</td>
            <td>1990-01-03</td>
            <td>9000.0</td>
        </tr>
        <tr>
            <td>193</td>
            <td>Britney</td>
            <td>Everett</td>
            <td>1997-03-03</td>
            <td>3900.0</td>
        </tr>
        <tr>
            <td>104</td>
            <td>Bruce</td>
            <td>Ernst</td>
            <td>1991-05-21</td>
            <td>6000.0</td>
        </tr>
        <tr>
            <td>179</td>
            <td>Charles</td>
            <td>Johnson</td>
            <td>2000-01-04</td>
            <td>6200.0</td>
        </tr>
        <tr>
            <td>109</td>
            <td>Daniel</td>
            <td>Faviet</td>
            <td>1994-08-16</td>
            <td>9000.0</td>
        </tr>
        <tr>
            <td>105</td>
            <td>David</td>
            <td>Austin</td>
            <td>1997-06-25</td>
            <td>4800.0</td>
        </tr>
        <tr>
            <td>114</td>
            <td>Den</td>
            <td>Raphaely</td>
            <td>1994-12-07</td>
            <td>11000.0</td>
        </tr>
        <tr>
            <td>107</td>
            <td>Diana</td>
            <td>Lorentz</td>
            <td>1999-02-07</td>
            <td>4200.0</td>
        </tr>
    </tbody>
</table>



## Filter data
### DISTINCT


```sql
%%sql 
select 
    salary 
from 
    employees 
order by 
    salary desc 
limit 10;
```

    Done.





<table>
    <thead>
        <tr>
            <th>salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>24000.0</td>
        </tr>
        <tr>
            <td>17000.0</td>
        </tr>
        <tr>
            <td>17000.0</td>
        </tr>
        <tr>
            <td>14000.0</td>
        </tr>
        <tr>
            <td>13500.0</td>
        </tr>
        <tr>
            <td>13000.0</td>
        </tr>
        <tr>
            <td>12000.0</td>
        </tr>
        <tr>
            <td>12000.0</td>
        </tr>
        <tr>
            <td>11000.0</td>
        </tr>
        <tr>
            <td>10000.0</td>
        </tr>
    </tbody>
</table>




```sql
%%sql 
select distinct 
    salary 
from 
    employees 
order by 
    salary desc 
limit 10;
```

    Done.





<table>
    <thead>
        <tr>
            <th>salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>24000.0</td>
        </tr>
        <tr>
            <td>17000.0</td>
        </tr>
        <tr>
            <td>14000.0</td>
        </tr>
        <tr>
            <td>13500.0</td>
        </tr>
        <tr>
            <td>13000.0</td>
        </tr>
        <tr>
            <td>12000.0</td>
        </tr>
        <tr>
            <td>11000.0</td>
        </tr>
        <tr>
            <td>10000.0</td>
        </tr>
        <tr>
            <td>9000.0</td>
        </tr>
        <tr>
            <td>8600.0</td>
        </tr>
    </tbody>
</table>




```sql
%%sql 
select 
    job_id,
    salary
from 
    employees
order by
    job_id,
    salary desc
limit 10;
```

    Done.





<table>
    <thead>
        <tr>
            <th>job_id</th>
            <th>salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1</td>
            <td>8300.0</td>
        </tr>
        <tr>
            <td>2</td>
            <td>12000.0</td>
        </tr>
        <tr>
            <td>3</td>
            <td>4400.0</td>
        </tr>
        <tr>
            <td>4</td>
            <td>24000.0</td>
        </tr>
        <tr>
            <td>5</td>
            <td>17000.0</td>
        </tr>
        <tr>
            <td>5</td>
            <td>17000.0</td>
        </tr>
        <tr>
            <td>6</td>
            <td>9000.0</td>
        </tr>
        <tr>
            <td>6</td>
            <td>8200.0</td>
        </tr>
        <tr>
            <td>6</td>
            <td>7800.0</td>
        </tr>
        <tr>
            <td>6</td>
            <td>7700.0</td>
        </tr>
    </tbody>
</table>




```sql
%%sql 
select distinct
    job_id,
    salary
from 
    employees
order by
    job_id,
    salary desc
limit 10;
```

    Done.





<table>
    <thead>
        <tr>
            <th>job_id</th>
            <th>salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1</td>
            <td>8300.0</td>
        </tr>
        <tr>
            <td>2</td>
            <td>12000.0</td>
        </tr>
        <tr>
            <td>3</td>
            <td>4400.0</td>
        </tr>
        <tr>
            <td>4</td>
            <td>24000.0</td>
        </tr>
        <tr>
            <td>5</td>
            <td>17000.0</td>
        </tr>
        <tr>
            <td>6</td>
            <td>9000.0</td>
        </tr>
        <tr>
            <td>6</td>
            <td>8200.0</td>
        </tr>
        <tr>
            <td>6</td>
            <td>7800.0</td>
        </tr>
        <tr>
            <td>6</td>
            <td>7700.0</td>
        </tr>
        <tr>
            <td>6</td>
            <td>6900.0</td>
        </tr>
    </tbody>
</table>



`DISTINCT` only keeps one `NULL`. 


```sql
%%sql 
select distinct
    phone_number
from 
    employees 
order by 
    phone_number
limit 10;
```

    Done.





<table>
    <thead>
        <tr>
            <th>phone_number</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>None</td>
        </tr>
        <tr>
            <td>515.123.4444</td>
        </tr>
        <tr>
            <td>515.123.4567</td>
        </tr>
        <tr>
            <td>515.123.4568</td>
        </tr>
        <tr>
            <td>515.123.4569</td>
        </tr>
        <tr>
            <td>515.123.5555</td>
        </tr>
        <tr>
            <td>515.123.7777</td>
        </tr>
        <tr>
            <td>515.123.8080</td>
        </tr>
        <tr>
            <td>515.123.8181</td>
        </tr>
        <tr>
            <td>515.123.8888</td>
        </tr>
    </tbody>
</table>



### LIMIT & OFFSET

`LIMIT` means to show many many rows. `OFFSET` means starting from which row. First row is 0. So `OFFSET 3` means starting from the fourth row. 


```sql
%%sql 
select 
    employee_id,
    first_name,
    last_name
from    
    employees
order by
    first_name
limit 10;
```

    Done.





<table>
    <thead>
        <tr>
            <th>employee_id</th>
            <th>first_name</th>
            <th>last_name</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>121</td>
            <td>Adam</td>
            <td>Fripp</td>
        </tr>
        <tr>
            <td>103</td>
            <td>Alexander</td>
            <td>Hunold</td>
        </tr>
        <tr>
            <td>115</td>
            <td>Alexander</td>
            <td>Khoo</td>
        </tr>
        <tr>
            <td>193</td>
            <td>Britney</td>
            <td>Everett</td>
        </tr>
        <tr>
            <td>104</td>
            <td>Bruce</td>
            <td>Ernst</td>
        </tr>
        <tr>
            <td>179</td>
            <td>Charles</td>
            <td>Johnson</td>
        </tr>
        <tr>
            <td>109</td>
            <td>Daniel</td>
            <td>Faviet</td>
        </tr>
        <tr>
            <td>105</td>
            <td>David</td>
            <td>Austin</td>
        </tr>
        <tr>
            <td>114</td>
            <td>Den</td>
            <td>Raphaely</td>
        </tr>
        <tr>
            <td>107</td>
            <td>Diana</td>
            <td>Lorentz</td>
        </tr>
    </tbody>
</table>




```sql
%%sql 
select 
    employee_id,
    first_name,
    last_name
from    
    employees
order by
    first_name
limit 5 offset 3;
```

    Done.





<table>
    <thead>
        <tr>
            <th>employee_id</th>
            <th>first_name</th>
            <th>last_name</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>193</td>
            <td>Britney</td>
            <td>Everett</td>
        </tr>
        <tr>
            <td>104</td>
            <td>Bruce</td>
            <td>Ernst</td>
        </tr>
        <tr>
            <td>179</td>
            <td>Charles</td>
            <td>Johnson</td>
        </tr>
        <tr>
            <td>109</td>
            <td>Daniel</td>
            <td>Faviet</td>
        </tr>
        <tr>
            <td>105</td>
            <td>David</td>
            <td>Austin</td>
        </tr>
    </tbody>
</table>



### Where


```sql
%%sql 
select  
    employee_id,
    first_name,
    last_name,
    salary
from 
    employees 
where
    salary > 14000 
order by 
    salary desc 
```

    Done.





<table>
    <thead>
        <tr>
            <th>employee_id</th>
            <th>first_name</th>
            <th>last_name</th>
            <th>salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>100</td>
            <td>Steven</td>
            <td>King</td>
            <td>24000.0</td>
        </tr>
        <tr>
            <td>101</td>
            <td>Neena</td>
            <td>Kochhar</td>
            <td>17000.0</td>
        </tr>
        <tr>
            <td>102</td>
            <td>Lex</td>
            <td>De Haan</td>
            <td>17000.0</td>
        </tr>
    </tbody>
</table>




```sql
%%sql 
select  
    employee_id,
    first_name,
    last_name,
    department_id
from 
    employees 
where
    department_id = 5
order by 
    first_name;
```

    Done.





<table>
    <thead>
        <tr>
            <th>employee_id</th>
            <th>first_name</th>
            <th>last_name</th>
            <th>department_id</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>121</td>
            <td>Adam</td>
            <td>Fripp</td>
            <td>5</td>
        </tr>
        <tr>
            <td>193</td>
            <td>Britney</td>
            <td>Everett</td>
            <td>5</td>
        </tr>
        <tr>
            <td>126</td>
            <td>Irene</td>
            <td>Mikkilineni</td>
            <td>5</td>
        </tr>
        <tr>
            <td>120</td>
            <td>Matthew</td>
            <td>Weiss</td>
            <td>5</td>
        </tr>
        <tr>
            <td>122</td>
            <td>Payam</td>
            <td>Kaufling</td>
            <td>5</td>
        </tr>
        <tr>
            <td>192</td>
            <td>Sarah</td>
            <td>Bell</td>
            <td>5</td>
        </tr>
        <tr>
            <td>123</td>
            <td>Shanta</td>
            <td>Vollman</td>
            <td>5</td>
        </tr>
    </tbody>
</table>




```sql
%%sql 
select  
    employee_id,
    first_name,
    last_name
from 
    employees 
where
    last_name = "Chen"
```

    Done.





<table>
    <thead>
        <tr>
            <th>employee_id</th>
            <th>first_name</th>
            <th>last_name</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>110</td>
            <td>John</td>
            <td>Chen</td>
        </tr>
    </tbody>
</table>



### Comparison oprators

- `=`: equal
- `<>`: not equal 
- `>`
- `>=`
- `<`
- `<=`

### Logical operators 
- `ALL`
- `AND`
- `ANY`
- `BETWEEN`
- `EXISTS`
- `IN`
- `LIKE`
- `NOT`
- `OR`
- `SOME`
- `IS NULL` 

#### AND


```sql
%%sql 
select first_name, last_name, salary 
from employees 
where salary > 5000 AND salary < 7000 
order by salary desc;
```

    Done.





<table>
    <thead>
        <tr>
            <th>first_name</th>
            <th>last_name</th>
            <th>salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Luis</td>
            <td>Popp</td>
            <td>6900.0</td>
        </tr>
        <tr>
            <td>Shanta</td>
            <td>Vollman</td>
            <td>6500.0</td>
        </tr>
        <tr>
            <td>Susan</td>
            <td>Mavris</td>
            <td>6500.0</td>
        </tr>
        <tr>
            <td>Charles</td>
            <td>Johnson</td>
            <td>6200.0</td>
        </tr>
        <tr>
            <td>Bruce</td>
            <td>Ernst</td>
            <td>6000.0</td>
        </tr>
        <tr>
            <td>Pat</td>
            <td>Fay</td>
            <td>6000.0</td>
        </tr>
    </tbody>
</table>



#### OR


```sql
%%sql 
select first_name, last_name, salary 
from employees 
where salary = 7000 OR salary = 8000; 
```

    Done.





<table>
    <thead>
        <tr>
            <th>first_name</th>
            <th>last_name</th>
            <th>salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Matthew</td>
            <td>Weiss</td>
            <td>8000.0</td>
        </tr>
        <tr>
            <td>Kimberely</td>
            <td>Grant</td>
            <td>7000.0</td>
        </tr>
    </tbody>
</table>



#### IS NULL


```sql
%%sql 
select first_name, last_name, phone_number 
from employees 
where phone_number IS NULL 
order by first_name, last_name;
```

    Done.





<table>
    <thead>
        <tr>
            <th>first_name</th>
            <th>last_name</th>
            <th>phone_number</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Charles</td>
            <td>Johnson</td>
            <td>None</td>
        </tr>
        <tr>
            <td>Jack</td>
            <td>Livingston</td>
            <td>None</td>
        </tr>
        <tr>
            <td>John</td>
            <td>Russell</td>
            <td>None</td>
        </tr>
        <tr>
            <td>Jonathon</td>
            <td>Taylor</td>
            <td>None</td>
        </tr>
        <tr>
            <td>Karen</td>
            <td>Partners</td>
            <td>None</td>
        </tr>
        <tr>
            <td>Kimberely</td>
            <td>Grant</td>
            <td>None</td>
        </tr>
    </tbody>
</table>



#### BETWEEN


```sql
%%sql 
select first_name, last_name, salary 
from employees 
where salary BETWEEN 9000 and 12000 
order by salary desc;
```

    Done.





<table>
    <thead>
        <tr>
            <th>first_name</th>
            <th>last_name</th>
            <th>salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Nancy</td>
            <td>Greenberg</td>
            <td>12000.0</td>
        </tr>
        <tr>
            <td>Shelley</td>
            <td>Higgins</td>
            <td>12000.0</td>
        </tr>
        <tr>
            <td>Den</td>
            <td>Raphaely</td>
            <td>11000.0</td>
        </tr>
        <tr>
            <td>Hermann</td>
            <td>Baer</td>
            <td>10000.0</td>
        </tr>
        <tr>
            <td>Alexander</td>
            <td>Hunold</td>
            <td>9000.0</td>
        </tr>
        <tr>
            <td>Daniel</td>
            <td>Faviet</td>
            <td>9000.0</td>
        </tr>
    </tbody>
</table>



#### IN


```sql
%%sql 
select first_name, last_name, department_id 
from employees 
where department_id IN (6, 8, 9)
order by department_id;
```

    Done.





<table>
    <thead>
        <tr>
            <th>first_name</th>
            <th>last_name</th>
            <th>department_id</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Alexander</td>
            <td>Hunold</td>
            <td>6</td>
        </tr>
        <tr>
            <td>Bruce</td>
            <td>Ernst</td>
            <td>6</td>
        </tr>
        <tr>
            <td>David</td>
            <td>Austin</td>
            <td>6</td>
        </tr>
        <tr>
            <td>Valli</td>
            <td>Pataballa</td>
            <td>6</td>
        </tr>
        <tr>
            <td>Diana</td>
            <td>Lorentz</td>
            <td>6</td>
        </tr>
        <tr>
            <td>John</td>
            <td>Russell</td>
            <td>8</td>
        </tr>
        <tr>
            <td>Karen</td>
            <td>Partners</td>
            <td>8</td>
        </tr>
        <tr>
            <td>Jonathon</td>
            <td>Taylor</td>
            <td>8</td>
        </tr>
        <tr>
            <td>Jack</td>
            <td>Livingston</td>
            <td>8</td>
        </tr>
        <tr>
            <td>Kimberely</td>
            <td>Grant</td>
            <td>8</td>
        </tr>
        <tr>
            <td>Charles</td>
            <td>Johnson</td>
            <td>8</td>
        </tr>
        <tr>
            <td>Steven</td>
            <td>King</td>
            <td>9</td>
        </tr>
        <tr>
            <td>Neena</td>
            <td>Kochhar</td>
            <td>9</td>
        </tr>
        <tr>
            <td>Lex</td>
            <td>De Haan</td>
            <td>9</td>
        </tr>
    </tbody>
</table>



#### LIKE


```sql
%%sql 
select employee_id, first_name, last_name 
from employees 
where first_name LIKE '_h%'
order by first_name;
```

    Done.





<table>
    <thead>
        <tr>
            <th>employee_id</th>
            <th>first_name</th>
            <th>last_name</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>179</td>
            <td>Charles</td>
            <td>Johnson</td>
        </tr>
        <tr>
            <td>123</td>
            <td>Shanta</td>
            <td>Vollman</td>
        </tr>
        <tr>
            <td>205</td>
            <td>Shelley</td>
            <td>Higgins</td>
        </tr>
        <tr>
            <td>116</td>
            <td>Shelli</td>
            <td>Baida</td>
        </tr>
    </tbody>
</table>



`_` represents a single character. 

`%` represents `0`, `1`, or multiple characters.

#### ALL, ANY

SQLITE does not support `ALL` or `ANY`. But there are alternatives. 

For example

```sql
SELECT * FROM employees
WHERE salary >= ALL (
    SELECT salary FROM employees WHERE department_id = 8
);
```

can be done via

```sql
SELECT * FROM employees
WHERE salary >= (
    SELECT MAX(salary) FROM employees WHERE department_id = 8
)
```

And

```sql
SELECT * FROM employees
WHERE salary >= ANY (
    SELECT salary FROM employees WHERE department_id = 8
);
```

can be achieved through

```sql
SELECT * FROM employees
WHERE salary >= (
    SELECT MIN(salary) FROM employees WHERE department_id = 8
);
```

or 

```sql
SELECT * FROM employees
WHERE salary IN (
    SELECT salary FROM employees WHERE department_id = 8
);
```

#### EXISTS

For example, show names of those who have dependents:


```sql
%%sql 
select first_name, last_name 
from employees e 
where EXISTS(
    select * from dependents d 
    where d.employee_id = e.employee_id
)
limit 10;
```

    Done.





<table>
    <thead>
        <tr>
            <th>first_name</th>
            <th>last_name</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Steven</td>
            <td>King</td>
        </tr>
        <tr>
            <td>Neena</td>
            <td>Kochhar</td>
        </tr>
        <tr>
            <td>Lex</td>
            <td>De Haan</td>
        </tr>
        <tr>
            <td>Alexander</td>
            <td>Hunold</td>
        </tr>
        <tr>
            <td>Bruce</td>
            <td>Ernst</td>
        </tr>
        <tr>
            <td>David</td>
            <td>Austin</td>
        </tr>
        <tr>
            <td>Valli</td>
            <td>Pataballa</td>
        </tr>
        <tr>
            <td>Diana</td>
            <td>Lorentz</td>
        </tr>
        <tr>
            <td>Nancy</td>
            <td>Greenberg</td>
        </tr>
        <tr>
            <td>Daniel</td>
            <td>Faviet</td>
        </tr>
    </tbody>
</table>



在我看来，上面的这行就说明了 sql 相比于 csv 的优势。通过 `employee_id` 这一栏，我们把两个数据连在一起，放在了一个数据库。

## Conditional Expression


```sql
%%sql 
SELECT first_name, last_name,
CASE 
    when salary < 3000 then 'low'
    when salary >= 3000 and salary <= 5000 then 'average'
    ELSE 'high'
END AS evaluation 
FROM employees
LIMIT 10;
```

    Done.





<table>
    <thead>
        <tr>
            <th>first_name</th>
            <th>last_name</th>
            <th>evaluation</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Steven</td>
            <td>King</td>
            <td>high</td>
        </tr>
        <tr>
            <td>Neena</td>
            <td>Kochhar</td>
            <td>high</td>
        </tr>
        <tr>
            <td>Lex</td>
            <td>De Haan</td>
            <td>high</td>
        </tr>
        <tr>
            <td>Alexander</td>
            <td>Hunold</td>
            <td>high</td>
        </tr>
        <tr>
            <td>Bruce</td>
            <td>Ernst</td>
            <td>high</td>
        </tr>
        <tr>
            <td>David</td>
            <td>Austin</td>
            <td>average</td>
        </tr>
        <tr>
            <td>Valli</td>
            <td>Pataballa</td>
            <td>average</td>
        </tr>
        <tr>
            <td>Diana</td>
            <td>Lorentz</td>
            <td>average</td>
        </tr>
        <tr>
            <td>Nancy</td>
            <td>Greenberg</td>
            <td>high</td>
        </tr>
        <tr>
            <td>Daniel</td>
            <td>Faviet</td>
            <td>high</td>
        </tr>
    </tbody>
</table>




```sql
%%sql 
SELECT 
    first_name, 
    last_name,
    phone_number,
    CASE
        WHEN phone_number IS NULL THEN 'No phone number'
        ELSE phone_number 
    END AS final_phone_number
FROM employees 
where phone_number IS NULL 
LIMIT 10
```

    Done.





<table>
    <thead>
        <tr>
            <th>first_name</th>
            <th>last_name</th>
            <th>phone_number</th>
            <th>final_phone_number</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>John</td>
            <td>Russell</td>
            <td>None</td>
            <td>No phone number</td>
        </tr>
        <tr>
            <td>Karen</td>
            <td>Partners</td>
            <td>None</td>
            <td>No phone number</td>
        </tr>
        <tr>
            <td>Jonathon</td>
            <td>Taylor</td>
            <td>None</td>
            <td>No phone number</td>
        </tr>
        <tr>
            <td>Jack</td>
            <td>Livingston</td>
            <td>None</td>
            <td>No phone number</td>
        </tr>
        <tr>
            <td>Kimberely</td>
            <td>Grant</td>
            <td>None</td>
            <td>No phone number</td>
        </tr>
        <tr>
            <td>Charles</td>
            <td>Johnson</td>
            <td>None</td>
            <td>No phone number</td>
        </tr>
    </tbody>
</table>



## Join multiple tables

### Alias


```sql
%%sql 

SELECT first_name, last_name, salary * 1.1 AS new_salary 
FROM employees 
ORDER BY new_salary DESC
LIMIT 10;
```

    Done.





<table>
    <thead>
        <tr>
            <th>first_name</th>
            <th>last_name</th>
            <th>new_salary</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Steven</td>
            <td>King</td>
            <td>26400.000000000004</td>
        </tr>
        <tr>
            <td>Neena</td>
            <td>Kochhar</td>
            <td>18700.0</td>
        </tr>
        <tr>
            <td>Lex</td>
            <td>De Haan</td>
            <td>18700.0</td>
        </tr>
        <tr>
            <td>John</td>
            <td>Russell</td>
            <td>15400.000000000002</td>
        </tr>
        <tr>
            <td>Karen</td>
            <td>Partners</td>
            <td>14850.000000000002</td>
        </tr>
        <tr>
            <td>Michael</td>
            <td>Hartstein</td>
            <td>14300.000000000002</td>
        </tr>
        <tr>
            <td>Nancy</td>
            <td>Greenberg</td>
            <td>13200.000000000002</td>
        </tr>
        <tr>
            <td>Shelley</td>
            <td>Higgins</td>
            <td>13200.000000000002</td>
        </tr>
        <tr>
            <td>Den</td>
            <td>Raphaely</td>
            <td>12100.000000000002</td>
        </tr>
        <tr>
            <td>Hermann</td>
            <td>Baer</td>
            <td>11000.0</td>
        </tr>
    </tbody>
</table>




```sql
%%sql 

SELECT e.first_name, e.last_name 
FROM employees AS e
LIMIT 10;
```

    Done.





<table>
    <thead>
        <tr>
            <th>first_name</th>
            <th>last_name</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Steven</td>
            <td>King</td>
        </tr>
        <tr>
            <td>Neena</td>
            <td>Kochhar</td>
        </tr>
        <tr>
            <td>Lex</td>
            <td>De Haan</td>
        </tr>
        <tr>
            <td>Alexander</td>
            <td>Hunold</td>
        </tr>
        <tr>
            <td>Bruce</td>
            <td>Ernst</td>
        </tr>
        <tr>
            <td>David</td>
            <td>Austin</td>
        </tr>
        <tr>
            <td>Valli</td>
            <td>Pataballa</td>
        </tr>
        <tr>
            <td>Diana</td>
            <td>Lorentz</td>
        </tr>
        <tr>
            <td>Nancy</td>
            <td>Greenberg</td>
        </tr>
        <tr>
            <td>Daniel</td>
            <td>Faviet</td>
        </tr>
    </tbody>
</table>



### Inner Join

取共有的。

![](https://www.sqltutorial.org/wp-content/uploads/2016/03/SQL-INNER-JOIN.png)

图片来源: https://www.sqltutorial.org/wp-content/uploads/2016/03/SQL-INNER-JOIN.png

我们来看一个例子：

![](https://www.sqltutorial.org/wp-content/uploads/2016/03/emp_dept_tables.png)

图片来源：https://www.sqltutorial.org/wp-content/uploads/2016/03/emp_dept_tables.png


```sql
%%sql 

SELECT department_id, department_name 
FROM departments 
WHERE department_id IN (1, 2, 3)
```

    Done.





<table>
    <thead>
        <tr>
            <th>department_id</th>
            <th>department_name</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>1</td>
            <td>Administration</td>
        </tr>
        <tr>
            <td>2</td>
            <td>Marketing</td>
        </tr>
        <tr>
            <td>3</td>
            <td>Purchasing</td>
        </tr>
    </tbody>
</table>




```sql
%%sql 
SELECT first_name, last_name, department_id 
FROM employees 
WHERE department_id IN (1, 2, 3)
ORDER BY department_id
```

    Done.





<table>
    <thead>
        <tr>
            <th>first_name</th>
            <th>last_name</th>
            <th>department_id</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Jennifer</td>
            <td>Whalen</td>
            <td>1</td>
        </tr>
        <tr>
            <td>Michael</td>
            <td>Hartstein</td>
            <td>2</td>
        </tr>
        <tr>
            <td>Pat</td>
            <td>Fay</td>
            <td>2</td>
        </tr>
        <tr>
            <td>Den</td>
            <td>Raphaely</td>
            <td>3</td>
        </tr>
        <tr>
            <td>Alexander</td>
            <td>Khoo</td>
            <td>3</td>
        </tr>
        <tr>
            <td>Shelli</td>
            <td>Baida</td>
            <td>3</td>
        </tr>
        <tr>
            <td>Sigal</td>
            <td>Tobias</td>
            <td>3</td>
        </tr>
        <tr>
            <td>Guy</td>
            <td>Himuro</td>
            <td>3</td>
        </tr>
        <tr>
            <td>Karen</td>
            <td>Colmenares</td>
            <td>3</td>
        </tr>
    </tbody>
</table>




```sql
%%sql 

SELECT 
    e.first_name,
    e.last_name, 
    e.department_id, 
    d.department_id,
    d.department_name 
FROM 
    employees AS e
        INNER JOIN
    departments AS d ON d.department_id = e.department_id 
WHERE 
    e.department_id IN (1, 2, 3)
```

    Done.





<table>
    <thead>
        <tr>
            <th>first_name</th>
            <th>last_name</th>
            <th>department_id</th>
            <th>department_id_1</th>
            <th>department_name</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>Jennifer</td>
            <td>Whalen</td>
            <td>1</td>
            <td>1</td>
            <td>Administration</td>
        </tr>
        <tr>
            <td>Michael</td>
            <td>Hartstein</td>
            <td>2</td>
            <td>2</td>
            <td>Marketing</td>
        </tr>
        <tr>
            <td>Pat</td>
            <td>Fay</td>
            <td>2</td>
            <td>2</td>
            <td>Marketing</td>
        </tr>
        <tr>
            <td>Den</td>
            <td>Raphaely</td>
            <td>3</td>
            <td>3</td>
            <td>Purchasing</td>
        </tr>
        <tr>
            <td>Alexander</td>
            <td>Khoo</td>
            <td>3</td>
            <td>3</td>
            <td>Purchasing</td>
        </tr>
        <tr>
            <td>Shelli</td>
            <td>Baida</td>
            <td>3</td>
            <td>3</td>
            <td>Purchasing</td>
        </tr>
        <tr>
            <td>Sigal</td>
            <td>Tobias</td>
            <td>3</td>
            <td>3</td>
            <td>Purchasing</td>
        </tr>
        <tr>
            <td>Guy</td>
            <td>Himuro</td>
            <td>3</td>
            <td>3</td>
            <td>Purchasing</td>
        </tr>
        <tr>
            <td>Karen</td>
            <td>Colmenares</td>
            <td>3</td>
            <td>3</td>
            <td>Purchasing</td>
        </tr>
    </tbody>
</table>



### LEFT JOIN 

![](https://www.sqltutorial.org/wp-content/uploads/2016/03/SQL-LEFT-JOIN.png)

图片来源：https://www.sqltutorial.org/wp-content/uploads/2016/03/SQL-LEFT-JOIN.png


```sql
%%sql 

SELECT country_id, country_name 
FROM countries 
WHERE country_id IN ('US', 'UK', 'CN')
```

    Done.





<table>
    <thead>
        <tr>
            <th>country_id</th>
            <th>country_name</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>CN</td>
            <td>China</td>
        </tr>
        <tr>
            <td>UK</td>
            <td>United Kingdom</td>
        </tr>
        <tr>
            <td>US</td>
            <td>United States of America</td>
        </tr>
    </tbody>
</table>




```sql
%%sql 

SELECT country_id, street_address, city 
FROM locations 
WHERE country_id IN ('US', 'UK', 'CN')
```

    Done.





<table>
    <thead>
        <tr>
            <th>country_id</th>
            <th>street_address</th>
            <th>city</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>US</td>
            <td>2014 Jabberwocky Rd</td>
            <td>Southlake</td>
        </tr>
        <tr>
            <td>US</td>
            <td>2011 Interiors Blvd</td>
            <td>South San Francisco</td>
        </tr>
        <tr>
            <td>US</td>
            <td>2004 Charade Rd</td>
            <td>Seattle</td>
        </tr>
        <tr>
            <td>UK</td>
            <td>8204 Arthur St</td>
            <td>London</td>
        </tr>
        <tr>
            <td>UK</td>
            <td>Magdalen Centre, The Oxford Science Park</td>
            <td>Oxford</td>
        </tr>
    </tbody>
</table>




```sql
%%sql 
SELECT 
    c.country_name,
    c.country_id,
    l.country_id,
    l.street_address,
    l.city 
FROM 
    countries AS c 
LEFT JOIN locations AS l on l.country_id = c.country_id 
WHERE 
    c.country_id IN ('US', 'UK', 'CN')
```

    Done.





<table>
    <thead>
        <tr>
            <th>country_name</th>
            <th>country_id</th>
            <th>country_id_1</th>
            <th>street_address</th>
            <th>city</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>China</td>
            <td>CN</td>
            <td>None</td>
            <td>None</td>
            <td>None</td>
        </tr>
        <tr>
            <td>United Kingdom</td>
            <td>UK</td>
            <td>UK</td>
            <td>8204 Arthur St</td>
            <td>London</td>
        </tr>
        <tr>
            <td>United Kingdom</td>
            <td>UK</td>
            <td>UK</td>
            <td>Magdalen Centre, The Oxford Science Park</td>
            <td>Oxford</td>
        </tr>
        <tr>
            <td>United States of America</td>
            <td>US</td>
            <td>US</td>
            <td>2014 Jabberwocky Rd</td>
            <td>Southlake</td>
        </tr>
        <tr>
            <td>United States of America</td>
            <td>US</td>
            <td>US</td>
            <td>2011 Interiors Blvd</td>
            <td>South San Francisco</td>
        </tr>
        <tr>
            <td>United States of America</td>
            <td>US</td>
            <td>US</td>
            <td>2004 Charade Rd</td>
            <td>Seattle</td>
        </tr>
    </tbody>
</table>




```sql
%%sql 
SELECT 
    c.country_name,
    c.country_id,
    l.country_id,
    l.street_address,
    l.city 
FROM 
    locations AS l
LEFT JOIN countries AS c on l.country_id = c.country_id 
WHERE 
    c.country_id IN ('US', 'UK', 'CN')
```

    Done.





<table>
    <thead>
        <tr>
            <th>country_name</th>
            <th>country_id</th>
            <th>country_id_1</th>
            <th>street_address</th>
            <th>city</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>United Kingdom</td>
            <td>UK</td>
            <td>UK</td>
            <td>8204 Arthur St</td>
            <td>London</td>
        </tr>
        <tr>
            <td>United Kingdom</td>
            <td>UK</td>
            <td>UK</td>
            <td>Magdalen Centre, The Oxford Science Park</td>
            <td>Oxford</td>
        </tr>
        <tr>
            <td>United States of America</td>
            <td>US</td>
            <td>US</td>
            <td>2014 Jabberwocky Rd</td>
            <td>Southlake</td>
        </tr>
        <tr>
            <td>United States of America</td>
            <td>US</td>
            <td>US</td>
            <td>2011 Interiors Blvd</td>
            <td>South San Francisco</td>
        </tr>
        <tr>
            <td>United States of America</td>
            <td>US</td>
            <td>US</td>
            <td>2004 Charade Rd</td>
            <td>Seattle</td>
        </tr>
    </tbody>
</table>




```sql
%%sql 
SELECT 
    c.country_name,
    c.country_id,
    l.country_id,
    l.street_address,
    l.city 
FROM 
    countries AS c 
INNER JOIN locations AS l on l.country_id = c.country_id 
WHERE 
    c.country_id IN ('US', 'UK', 'CN')
```

    Done.





<table>
    <thead>
        <tr>
            <th>country_name</th>
            <th>country_id</th>
            <th>country_id_1</th>
            <th>street_address</th>
            <th>city</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>United Kingdom</td>
            <td>UK</td>
            <td>UK</td>
            <td>8204 Arthur St</td>
            <td>London</td>
        </tr>
        <tr>
            <td>United Kingdom</td>
            <td>UK</td>
            <td>UK</td>
            <td>Magdalen Centre, The Oxford Science Park</td>
            <td>Oxford</td>
        </tr>
        <tr>
            <td>United States of America</td>
            <td>US</td>
            <td>US</td>
            <td>2014 Jabberwocky Rd</td>
            <td>Southlake</td>
        </tr>
        <tr>
            <td>United States of America</td>
            <td>US</td>
            <td>US</td>
            <td>2011 Interiors Blvd</td>
            <td>South San Francisco</td>
        </tr>
        <tr>
            <td>United States of America</td>
            <td>US</td>
            <td>US</td>
            <td>2004 Charade Rd</td>
            <td>Seattle</td>
        </tr>
    </tbody>
</table>



## Aggregate functions

待续
