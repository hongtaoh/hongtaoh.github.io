---
title: Understanding igraph's degree distribution function and plotting the distribution in R
author: Hongtao Hao
date: '2020-08-19'
slug: igraph-distribution
categories: []
tags: []
toc: []
---



<p>The R package <code>igraph</code> is very useful. However, its <code>degree</code> and <code>degree_distribution</code> function is not so straightforward. Also, it might be challenging to plot degree distribution.</p>
<div id="getting-a-deeper-understanding-of-degree-and-degree_distribution" class="section level2">
<h2>Getting a deeper understanding of <code>degree()</code> and <code>degree_distribution()</code></h2>
<p>To explore these two function, let’s first draw a simple network.</p>
<pre class="r"><code>library(igraph)</code></pre>
<pre class="r"><code>g1 &lt;- graph( edges=c(1,2, 1,3, 2,3, 3,4), n=4, directed=FALSE)
plot(g1)</code></pre>
<p><img src="/en/blog/2020-08-19-igraph-distribution_files/figure-html/unnamed-chunk-2-1.png" width="672" />
Okay, now let’s have a look at its nodes’ degrees and its degree distribution.</p>
<pre class="r"><code>deg_1 &lt;- degree(g1)
deg_1</code></pre>
<pre><code>## [1] 2 2 3 1</code></pre>
<p>But does this result mean? It means that the degree of node1 is <span class="math inline">\(2\)</span>, the degree of node2 is <span class="math inline">\(2\)</span>, the degree of node3 is <span class="math inline">\(3\)</span>, and the degree of node4 is <span class="math inline">\(1\)</span>.</p>
<p>Okay. Let’s have a look at <code>g1</code>’s degree distribution:</p>
<pre class="r"><code>degree_distribution(g1)</code></pre>
<pre><code>## [1] 0.00 0.25 0.50 0.25</code></pre>
<p>What does this result mean then? Does it stand for the value of node <span class="math inline">\(1-4\)</span>. No. It means the <strong>relative frequency</strong> of all the degrees, i.e., <span class="math inline">\(1, 2, 3\)</span>, as is shown in the result of <code>degree(g1)</code>. Wait, but there are four values in the result above, <span class="math inline">\(0.00, 0.25, 0.50, 0.25\)</span>. Well, this is because the first value is for degree <span class="math inline">\(0\)</span>.</p>
<p>Conclusion: <code>degree()</code> will tell us the degree of all the nodes. <code>degree_distribution()</code> will tell us the <strong>relative frequency</strong> of all the degrees.</p>
<p>Then, we may wonder, what if we don’t have all the degrees from the minimum to maximum. For example, if we only have degrees of <span class="math inline">\(1,2,4,9\)</span>, will the <code>degree_distribution()</code> function show us the relative frequency of degree <span class="math inline">\(5\)</span> (which should be zero)?</p>
<p>Let’s try.</p>
<pre class="r"><code>g2 &lt;- graph( edges=c(1,2, 1,3, 2,3, 3,4, 4,5, 4,6, 4,7, 
                     4,8, 4,9, 4,10, 3,11, 2,12,
                     4,13, 4,14, 2,15, 6,12, 7,10), 
             n=15, directed=FALSE)
plot(g2)</code></pre>
<p><img src="/en/blog/2020-08-19-igraph-distribution_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>deg_2 &lt;- degree(g2)
deg_2</code></pre>
<pre><code>##  [1] 2 4 4 9 1 2 2 1 1 2 1 2 1 1 1</code></pre>
<pre class="r"><code>degree_distribution(g2)</code></pre>
<pre><code>##  [1] 0.00000000 0.46666667 0.33333333 0.00000000 0.13333333 0.00000000
##  [7] 0.00000000 0.00000000 0.00000000 0.06666667</code></pre>
<p>As we can see above, yes, <strong>it will</strong>. It displays relative frequencies for all possible degrees from <span class="math inline">\(0\)</span> to <span class="math inline">\(9\)</span>.</p>
</div>
<div id="plotting-the-distribution" class="section level2">
<h2>Plotting the distribution</h2>
<p>Let’s plot it.</p>
<p>First, you might be thinking of histogram:</p>
<pre class="r"><code>hist(degree(g1))</code></pre>
<p><img src="/en/blog/2020-08-19-igraph-distribution_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>However,as we can ses above, it doesn’t make much sense because all of the degrees are discrete numbers. Let’s try bar plot instead.</p>
<pre class="r"><code>t1 &lt;- table (deg_1)
sum(t1)</code></pre>
<pre><code>## [1] 4</code></pre>
<pre class="r"><code>relafreq_1 &lt;- t1/sum(t1)
barplot(relafreq_1, xlab = &quot;k&quot;, ylab = &quot;Relative frequencies&quot;, 
        main = &quot;Degree distribution of g1&quot;,
        col = &quot;orange&quot;)</code></pre>
<p><img src="/en/blog/2020-08-19-igraph-distribution_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>It works.</p>
<p>Let’s plot <code>g2</code> as well.</p>
<pre class="r"><code>t2 &lt;- table (deg_2)
sum(t2)</code></pre>
<pre><code>## [1] 15</code></pre>
<pre class="r"><code>relafreq_2 &lt;- t2/sum(t2)
barplot(relafreq_2, xlab = &quot;k&quot;, ylab = &quot;Relative frequencies&quot;, 
        main =&quot;Degree distribution of g2&quot;,
        col = &quot;skyblue&quot;)</code></pre>
<p><img src="/en/blog/2020-08-19-igraph-distribution_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>We find that the y-axis scale is too short for our values. I found a solution <a href="https://stackoverflow.com/a/50193822/13716814">here</a>. Before looking at the solution, let’s first try solving it by ourselves.</p>
<p>What’s the problem here? The problem is that the y-axis scale is too short. To adjust y-axis scale, let’s try <code>ylim</code> first.</p>
<p>What do we need to set <code>ylim</code>? As <a href="https://stackoverflow.com/users/3239578/sebkopf">sebkopf</a> noted <a href="https://stackoverflow.com/a/23051088/13716814">here</a> on <a href="https://stackoverflow.com/">stackoverflow</a>, we simply need to set the minimum and maximum values using, for example, <code>c()</code>.</p>
<p>Naturally, we may think of <code>max()</code>. Let’s try:</p>
<pre class="r"><code>barplot(relafreq_2, xlab=&quot;k&quot;, ylab = &quot;Relative frequencies&quot;, 
        main=&quot;Degree distribution of g2&quot;,
        col = &quot;skyblue&quot;,
        ylim = c(0, max(relafreq_2)))</code></pre>
<p><img src="/en/blog/2020-08-19-igraph-distribution_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>The y-axis scale is still too short.</p>
<p>We may use <code>max(t2/sum(t2))+0.1</code>. It of course will be fine here, setting the y-axis scale to be <span class="math inline">\([0,0.5]\)</span>:</p>
<pre class="r"><code>barplot(relafreq_2, xlab=&quot;k&quot;, ylab = &quot;Relative frequencies&quot;, 
        main=&quot;Degree distribution of g2&quot;,
        col = &quot;skyblue&quot;,
        ylim = c(0, max(relafreq_2+0.1)))</code></pre>
<p><img src="/en/blog/2020-08-19-igraph-distribution_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>However, this method may not be applicable to other situations. Is there a better way? Yes, let’s try the <code>pretty()</code> function mentioned above. Read <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/pretty.html">here</a> and <a href="https://statisticsglobe.com/pretty-r-function">here</a> to understand this function.</p>
<p>Basically, <code>pretty()</code> function will return a sequence of values that are equally spaced and cover the minimum and maximum values of our input. For example:</p>
<pre class="r"><code>a &lt;- c(0,1,2,3,0.5,1.2,0.001)
pretty(a)</code></pre>
<pre><code>## [1] 0.0 0.5 1.0 1.5 2.0 2.5 3.0</code></pre>
<pre class="r"><code>c &lt;- 0.1:0.5
pretty(c)</code></pre>
<pre><code>## [1] 0.0 0.1</code></pre>
<pre class="r"><code>d&lt;- 0:10
pretty(d)</code></pre>
<pre><code>## [1]  0  2  4  6  8 10</code></pre>
<p>Be aware that <code>pretty()</code> won’t be able to process a list:</p>
<pre class="r"><code>b &lt;- list(0,1,2,3,0.5,1.2, 0.001)
# pretty(b)</code></pre>
<p>Then, what will happen if we use <code>pretty(t2/sum(t2))</code>?</p>
<pre class="r"><code>pretty(t2/sum(t2))</code></pre>
<pre><code>## [1] 0.0 0.1 0.2 0.3 0.4 0.5</code></pre>
<p>It works, right? However, for <code>ylim</code>, we need a min and max. How to get them? We can use the <a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/range"><code>range()</code> function</a>, which will return <a href="https://rstudio-education.github.io/hopr/r-objects.html#atomic-vectors">a vector</a> that contains the min and max of our input.</p>
<pre class="r"><code>barplot(relafreq_2, xlab=&quot;k&quot;, ylab = &quot;Relative frequencies&quot;, 
        main=&quot;Degree distribution of g2&quot;,
        col = &quot;skyblue&quot;,
        ylim = range(pretty(c(0,relafreq_2))))</code></pre>
<p><img src="/en/blog/2020-08-19-igraph-distribution_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Some of you may wonder, why couldn’t we just use range(pretty(relafreq_2)). Well, we could. The thing is, in <code>g2</code>, if all degrees have appeared at least once, then using <code>range(pretty(relafreq_2))</code> rather than <code>range(pretty(c(0,relafreq_2)))</code> means that the start of <code>ylim</code> won’t be <span class="math inline">\(0\)</span>, I guess. So it’s safer to use <code>range(pretty(c(0,relafreq_2)))</code>.</p>
</div>
<div id="going-back-to-histogram" class="section level2">
<h2>Going back to histogram</h2>
<p>In the <a href="https://kateto.net/networks-r-igraph">igraph tutorial</a> by <a href="https://kateto.net/">Dr. Katya Ognyanova</a>, I saw that she showed the node degrees using histograms.
On second thought, I realized it’s not necessarily a bad idea to show node degrees via a histogram. After all, when the size of the network is huge and the node degrees vary greatly, a histogram isn’t that much different from a bar plot.</p>
<p>Why do I say that they are not that different? I’ll explain it using an example of a random graph.</p>
<pre class="r"><code>set.seed(1234)
random_graph &lt;- sample_gnp(1000, 1/1000, directed = FALSE, loops = FALSE)
plot(random_graph) # It&#39;s not very pretty...</code></pre>
<p><img src="/en/blog/2020-08-19-igraph-distribution_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>Let’s draw its nodes degree</p>
<pre class="r"><code>deg_random &lt;- degree(random_graph)
hist(deg_random, breaks = seq(0,(max(deg_random)+1), by=0.5), 
     main = &quot;Histogram of nodes degree for random_graph&quot;,
     xlab = &quot;k&quot;,
     col = &quot;skyblue&quot;)</code></pre>
<p><img src="/en/blog/2020-08-19-igraph-distribution_files/figure-html/unnamed-chunk-18-1.png" width="672" /></p>
<p>Then, let’s compare the above histogram with the corresponding bar chart:</p>
<pre class="r"><code>t_random &lt;- table(deg_random)
relafreq_random &lt;- t_random/sum(t_random)
barplot(relafreq_random, xlab = &quot;k&quot;,
        ylab = &quot;Relative frequencies&quot;,
        main = &quot;Degree distribution of random_graph&quot;,
        ylim = range(pretty(c(0,relafreq_random))),
        col = &quot;orange&quot;)</code></pre>
<p><img src="/en/blog/2020-08-19-igraph-distribution_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>They are not that different, right? Except for the fact that the histogram captures the absolute frequencies whereas the bar chart displays relative ones.</p>
<p>If you are careful enough, you’ll find that there is a minor issue with the histogram above: the range of [0,1] shows the frequencies of <span class="math inline">\(k=0\)</span> and <span class="math inline">\(k=1\)</span> combined. How to solve this problem?</p>
<p>We can simply change the breaks. Set it as <code>breaks = seq(0,(max(deg_random)+1), by=0.5)</code>. I learned it from <a href="https://stackoverflow.com/a/14585847/13716814">here</a>.</p>
<pre class="r"><code>hist(deg_random, breaks = seq(-1,(max(deg_random)+1), by=0.5), 
     main = &quot;Histogram of nodes degree for random_graph&quot;,
     xlab = &quot;k&quot;, 
     col = &quot;skyblue&quot;
     )</code></pre>
<p><img src="/en/blog/2020-08-19-igraph-distribution_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>How to solve the problem that the y-axis scale is too short?</p>
<pre class="r"><code>hist(deg_random, breaks = seq(-1,(max(deg_random)+1), by=0.5), 
     main = &quot;Histogram of nodes degree for random_graph&quot;,
     xlab = &quot;k&quot;, 
     col = &quot;skyblue&quot;,
     ylim = range(pretty(c(0,table(deg_random))))
     )</code></pre>
<p><img src="/en/blog/2020-08-19-igraph-distribution_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>When deciding on the breaks of the histogram, <a href="https://kateto.net/">Dr. Katya Ognyanova</a> used <code>vcount()-1</code>. This worked in the example she provided but I think it’s not the best option. For example, if there are <span class="math inline">\(1,000\)</span> vertices, and the maximum degree is only <span class="math inline">\(100\)</span>, we cannot use <code>vcount()-1</code>, which is <span class="math inline">\(999\)</span> to denote the max on the <code>x-axis</code>. A better alternative might be <code>breaks=0:max()+1</code>.</p>
<pre class="r"><code>hist(deg_2, breaks = seq(-1,(max(deg_2)+1), by=0.5), 
     main=&quot;Histogram of node degree&quot;,
     xlab = &quot;k&quot;,
     col = &quot;skyblue&quot;)</code></pre>
<p><img src="/en/blog/2020-08-19-igraph-distribution_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>Then applying it the <code>g1</code>:</p>
<pre class="r"><code>hist(deg_1, breaks = seq(-1,(max(deg_1)+1), by=0.5), 
     main=&quot;Histogram of node degree&quot;,
     xlab = &quot;k&quot;,
     col = &quot;skyblue&quot;)</code></pre>
<p><img src="/en/blog/2020-08-19-igraph-distribution_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>How to draw barplot?</p>
<p>How to draw hist?</p>
</div>
